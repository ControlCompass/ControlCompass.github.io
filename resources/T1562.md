# T1562: Impair Defenses
**MITRE ATT&CK Tactic(s):** Defense Evasion

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1562)**
<blockquote>Adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms. This not only involves impairing preventative defenses, such as firewalls and anti-virus, but also detection capabilities that defenders can use to audit activity and identify malicious behavior. This may also span both native defenses as well as supplemental capabilities installed by users and administrators.

Adversaries could also target event aggregation and analysis mechanisms, or otherwise disrupt these procedures by altering other system components.</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**16

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Emulated File Analysis](https://d3fend.mitre.org/techniques/d3f:EmulatedFileAnalysis)
* [Dynamic Analysis](https://d3fend.mitre.org/techniques/d3f:DynamicAnalysis)
* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)
* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)
* [Process Self-Modification Detection](https://d3fend.mitre.org/techniques/d3f:ProcessSelf-ModificationDetection)
* [Process Spawn Analysis](https://d3fend.mitre.org/techniques/d3f:ProcessSpawnAnalysis)
* [Application Configuration Hardening](https://d3fend.mitre.org/techniques/d3f:ApplicationConfigurationHardening)
* [Process Termination](https://d3fend.mitre.org/techniques/d3f:ProcessTermination)
* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)
* [Hardware-based Process Isolation](https://d3fend.mitre.org/techniques/d3f:Hardware-basedProcessIsolation)
* [Executable Allowlisting](https://d3fend.mitre.org/techniques/d3f:ExecutableAllowlisting)
* [System Daemon Monitoring](https://d3fend.mitre.org/techniques/d3f:SystemDaemonMonitoring)
* [System Init Config Analysis](https://d3fend.mitre.org/techniques/d3f:SystemInitConfigAnalysis)
* [Executable Denylisting](https://d3fend.mitre.org/techniques/d3f:ExecutableDenylisting)
* [Process Lineage Analysis](https://d3fend.mitre.org/techniques/d3f:ProcessLineageAnalysis)
* [Mandatory Access Control](https://d3fend.mitre.org/techniques/d3f:MandatoryAccessControl)

## Technical Controls (Detection Rules)
### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**7

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/cloud/aws/aws_securityhub_finding_evasion.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/aws_securityhub_finding_evasion.yml)
* [sigma/rules/cloud/azure/azure_kubernetes_events_deleted.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/azure/azure_kubernetes_events_deleted.yml)
* [sigma/rules/cloud/gcp/gcp_firewall_rule_modified_or_deleted.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/gcp/gcp_firewall_rule_modified_or_deleted.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_etw_modification_cmdline.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_etw_modification_cmdline.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_sysmon_driver_unload.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysmon_driver_unload.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_write_protect_for_storage_disabled.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_write_protect_for_storage_disabled.yml)
* [sigma/rules/windows/registry/registry_delete/registry_delete_removal_sd_value_scheduled_task_hide.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_delete/registry_delete_removal_sd_value_scheduled_task_hide.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**47

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/cloud/o365_bypass_mfa_via_trusted_ip.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/o365_bypass_mfa_via_trusted_ip.yml)
* [security_content/detections/cloud/aws_network_access_control_list_created_with_all_open_ports.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_network_access_control_list_created_with_all_open_ports.yml)
* [security_content/detections/cloud/aws_network_access_control_list_deleted.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_network_access_control_list_deleted.yml)
* [security_content/detections/endpoint/disable_windows_behavior_monitoring.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_windows_behavior_monitoring.yml)
* [security_content/detections/endpoint/disable_defender_mpengine_registry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_defender_mpengine_registry.yml)
* [security_content/detections/endpoint/firewall_allowed_program_enable.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/firewall_allowed_program_enable.yml)
* [security_content/detections/endpoint/excessive_usage_of_taskkill.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/excessive_usage_of_taskkill.yml)
* [security_content/detections/endpoint/disabling_firewall_with_netsh.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_firewall_with_netsh.yml)
* [security_content/detections/endpoint/disabling_controlpanel.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_controlpanel.yml)
* [security_content/detections/endpoint/disabling_defender_services.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_defender_services.yml)
* [security_content/detections/endpoint/hide_user_account_from_sign_in_screen.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/hide_user_account_from_sign_in_screen.yml)
* [security_content/detections/endpoint/powershell_windows_defender_exclusion_commands.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/powershell_windows_defender_exclusion_commands.yml)
* [security_content/detections/endpoint/add_or_set_windows_defender_exclusion.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/add_or_set_windows_defender_exclusion.yml)
* [security_content/detections/endpoint/disable_schedule_task.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_schedule_task.yml)
* [security_content/detections/endpoint/unloading_amsi_via_reflection.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/unloading_amsi_via_reflection.yml)
* [security_content/detections/endpoint/wmic_noninteractive_app_uninstallation.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/wmic_noninteractive_app_uninstallation.yml)
* [security_content/detections/endpoint/windows_defender_exclusion_registry_entry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_defender_exclusion_registry_entry.yml)
* [security_content/detections/endpoint/disable_defender_spynet_reporting.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_defender_spynet_reporting.yml)
* [security_content/detections/endpoint/disable_registry_tool.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_registry_tool.yml)
* [security_content/detections/endpoint/windows_disableantispyware_reg.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_disableantispyware_reg.yml)
* [security_content/detections/endpoint/attempt_to_stop_security_service.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/attempt_to_stop_security_service.yml)
* [security_content/detections/endpoint/disable_defender_blockatfirstseen_feature.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_defender_blockatfirstseen_feature.yml)
* [security_content/detections/endpoint/disable_amsi_through_registry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_amsi_through_registry.yml)
* [security_content/detections/endpoint/disable_show_hidden_files.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_show_hidden_files.yml)
* [security_content/detections/endpoint/disabling_folderoptions_windows_feature.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_folderoptions_windows_feature.yml)
* [security_content/detections/endpoint/disable_defender_submit_samples_consent_feature.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_defender_submit_samples_consent_feature.yml)
* [security_content/detections/endpoint/disable_etw_through_registry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_etw_through_registry.yml)
* [security_content/detections/endpoint/allow_file_and_printing_sharing_in_firewall.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/allow_file_and_printing_sharing_in_firewall.yml)
* [security_content/detections/endpoint/excessive_number_of_service_control_start_as_disabled.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/excessive_number_of_service_control_start_as_disabled.yml)
* [security_content/detections/endpoint/disable_windows_smartscreen_protection.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_windows_smartscreen_protection.yml)
* [security_content/detections/endpoint/windows_excessive_disabled_services_event.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_excessive_disabled_services_event.yml)
* [security_content/detections/endpoint/powershell_remove_windows_defender_directory.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/powershell_remove_windows_defender_directory.yml)
* [security_content/detections/endpoint/disabling_norun_windows_app.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_norun_windows_app.yml)
* [security_content/detections/endpoint/disable_defender_enhanced_notification.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_defender_enhanced_notification.yml)
* [security_content/detections/endpoint/unload_sysmon_filter_driver.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/unload_sysmon_filter_driver.yml)
* [security_content/detections/endpoint/disabling_cmd_application.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_cmd_application.yml)
* [security_content/detections/endpoint/windows_dism_remove_defender.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_dism_remove_defender.yml)
* [security_content/detections/endpoint/processes_launching_netsh.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/processes_launching_netsh.yml)
* [security_content/detections/endpoint/powershell_disable_security_monitoring.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/powershell_disable_security_monitoring.yml)
* [security_content/detections/endpoint/windows_event_for_service_disabled.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_event_for_service_disabled.yml)
* [security_content/detections/endpoint/etw_registry_disabled.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/etw_registry_disabled.yml)
* [security_content/detections/endpoint/process_kill_base_on_file_path.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/process_kill_base_on_file_path.yml)
* [security_content/detections/endpoint/disabling_task_manager.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_task_manager.yml)
* [security_content/detections/endpoint/allow_network_discovery_in_firewall.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/allow_network_discovery_in_firewall.yml)
* [security_content/detections/endpoint/disabling_systemrestore_in_registry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_systemrestore_in_registry.yml)
* [security_content/detections/endpoint/disable_defender_antivirus_registry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_defender_antivirus_registry.yml)
* [security_content/detections/endpoint/disable_windows_app_hotkeys.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_windows_app_hotkeys.yml)


## Offensive Security Tests
### [Stratus Red Team](https://github.com/DataDog/stratus-red-team/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 21

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://stratus-red-team.cloud/attack-techniques/):

* [aws.defense-evasion.organizations-leave](https://stratus-red-team.cloud/attack-techniques/aws/aws.defense-evasion.organizations-leave/)

