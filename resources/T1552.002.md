# T1552.002: Credentials in Registry
**MITRE ATT&CK Tactic(s):** Credential Access

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1552/002)**
<blockquote>Adversaries may search the Registry on compromised systems for insecurely stored credentials. The Windows Registry stores configuration information that can be used by the system or other programs. Adversaries may query the Registry looking for credentials and passwords that have been stored for use by other programs or services. Sometimes these credentials are used for automatic logons.

Example commands to find Registry keys related to password information: (Citation: Pentestlab Stored Credentials)

* Local Machine Hive: <code>reg query HKLM /f password /t REG_SZ /s</code>
* Current User Hive: <code>reg query HKCU /f password /t REG_SZ /s</code></blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**4

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Decoy User Credential](https://d3fend.mitre.org/techniques/d3f:DecoyUserCredential)
* [Credential Compromise Scope Analysis](https://d3fend.mitre.org/techniques/d3f:CredentialCompromiseScopeAnalysis)
* [Authentication Cache Invalidation](https://d3fend.mitre.org/techniques/d3f:AuthenticationCacheInvalidation)
* [Credential Transmission Scoping](https://d3fend.mitre.org/techniques/d3f:CredentialTransmissionScoping)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2020-09-004.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2020-09-004.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**3

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/windows/builtin/security/win_remote_registry_management_using_reg_utility.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_remote_registry_management_using_reg_utility.yml)
* [sigma/rules/windows/builtin/security/win_sam_registry_hive_handle_request.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_sam_registry_hive_handle_request.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_enumeration_for_credentials_in_registry.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_enumeration_for_credentials_in_registry.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**2

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/add_defaultuser_and_password_in_registry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/add_defaultuser_and_password_in_registry.yml)
* [security_content/detections/endpoint/auto_admin_logon_registry_entry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/auto_admin_logon_registry_entry.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**2

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1552.002/T1552.002.yaml):

* Enumeration for Credentials in Registry
* Enumeration for PuTTY Credentials in Registry

