# T1105: Ingress Tool Transfer
**MITRE ATT&CK Tactic(s):** Command and Control

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1105)**
<blockquote>Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**9

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Network Traffic Community Deviation](https://d3fend.mitre.org/techniques/d3f:NetworkTrafficCommunityDeviation)
* [Per Host Download-Upload Ratio Analysis](https://d3fend.mitre.org/techniques/d3f:PerHostDownload-UploadRatioAnalysis)
* [Protocol Metadata Anomaly Detection](https://d3fend.mitre.org/techniques/d3f:ProtocolMetadataAnomalyDetection)
* [Relay Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:RelayPatternAnalysis)
* [User Geolocation Logon Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:UserGeolocationLogonPatternAnalysis)
* [Client-server Payload Profiling](https://d3fend.mitre.org/techniques/d3f:Client-serverPayloadProfiling)
* [Remote Terminal Session Detection](https://d3fend.mitre.org/techniques/d3f:RemoteTerminalSessionDetection)
* [Inbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:InboundTrafficFiltering)
* [Outbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:OutboundTrafficFiltering)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:**4

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-07-001.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-07-001.yaml)
* [car/analytics/CAR-2021-05-005.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-05-005.yaml)
* [car/analytics/CAR-2021-05-006.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-05-006.yaml)
* [car/analytics/CAR-2021-05-007.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-05-007.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**32

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/linux/builtin/lnx_file_copy.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/builtin/lnx_file_copy.yml)
* [sigma/rules/network/cisco/aaa/cisco_cli_moving_data.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/network/cisco/aaa/cisco_cli_moving_data.yml)
* [sigma/rules/network/zeek/zeek_http_executable_download_from_webdav.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/network/zeek/zeek_http_executable_download_from_webdav.yml)
* [sigma/rules/proxy/proxy_download_susp_dyndns.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/proxy/proxy_download_susp_dyndns.yml)
* [sigma/rules/windows/dns_query/dns_query_win_lobas_appinstaller.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/dns_query/dns_query_win_lobas_appinstaller.yml)
* [sigma/rules/windows/file_event/file_event_win_susp_desktopimgdownldr_file.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_susp_desktopimgdownldr_file.yml)
* [sigma/rules/windows/network_connection/net_connection_win_binary_github_com.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_binary_github_com.yml)
* [sigma/rules/windows/network_connection/net_connection_win_binary_susp_com.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_binary_susp_com.yml)
* [sigma/rules/windows/network_connection/net_connection_win_imewdbld.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_imewdbld.yml)
* [sigma/rules/windows/network_connection/net_connection_win_susp_prog_location_network_connection.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_susp_prog_location_network_connection.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_greenbug_may20.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_greenbug_may20.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_pandemic.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_pandemic.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_headless_browser_file_download.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_headless_browser_file_download.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_lolbas_diantz_remote_cab.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbas_diantz_remote_cab.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_lolbas_extrac32.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbas_extrac32.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_lolbas_replace.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbas_replace.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_msedge_minimized_download.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_msedge_minimized_download.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_certreq_download.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_certreq_download.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_certutil_command.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_certutil_command.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_cmd_http_appdata.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_cmd_http_appdata.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_curl_download.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_curl_download.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_curl_fileupload.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_curl_fileupload.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_curl_start_combo.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_curl_start_combo.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_desktopimgdownldr.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_desktopimgdownldr.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_file_download_via_gfxdownloadwrapper.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_file_download_via_gfxdownloadwrapper.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_finger_usage.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_finger_usage.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_mpcmdrun_download.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_mpcmdrun_download.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_msiexec_web_install.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_msiexec_web_install.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_msoffice.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_msoffice.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_ps_downloadfile.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_ps_downloadfile.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_wuauclt.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_wuauclt.yml)
* [sigma/rules/windows/registry/registry_event/registry_event_apt_pandemic.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_apt_pandemic.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**14

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/wget_download_and_bash_execution.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/wget_download_and_bash_execution.yml)
* [security_content/detections/endpoint/certutil_download_with_verifyctl_and_split_arguments.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/certutil_download_with_verifyctl_and_split_arguments.yml)
* [security_content/detections/endpoint/ssa___windows_curl_upload_to_remote_destination.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ssa___windows_curl_upload_to_remote_destination.yml)
* [security_content/detections/endpoint/log4shell_cve_2021_44228_exploitation.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/log4shell_cve_2021_44228_exploitation.yml)
* [security_content/detections/endpoint/windows_curl_upload_to_remote_destination.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_curl_upload_to_remote_destination.yml)
* [security_content/detections/endpoint/download_files_using_telegram.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/download_files_using_telegram.yml)
* [security_content/detections/endpoint/curl_download_and_bash_execution.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/curl_download_and_bash_execution.yml)
* [security_content/detections/endpoint/certutil_download_with_urlcache_and_split_arguments.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/certutil_download_with_urlcache_and_split_arguments.yml)
* [security_content/detections/endpoint/ssa___windows_powershell_start_bitstransfer.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ssa___windows_powershell_start_bitstransfer.yml)
* [security_content/detections/endpoint/windows_curl_download_to_suspicious_path.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_curl_download_to_suspicious_path.yml)
* [security_content/detections/endpoint/bitsadmin_download_file.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/bitsadmin_download_file.yml)
* [security_content/detections/endpoint/ssa___windows_bitsadmin_download_file.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ssa___windows_bitsadmin_download_file.yml)
* [security_content/detections/endpoint/ssa___windows_certutil_verifyctl_download.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ssa___windows_certutil_verifyctl_download.yml)
* [security_content/detections/endpoint/ssa___windows_certutil_urlcache_download.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ssa___windows_certutil_urlcache_download.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**20

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1105/T1105.yaml):

* rsync remote file copy (push)
* rsync remote file copy (pull)
* scp remote file copy (push)
* scp remote file copy (pull)
* sftp remote file copy (push)
* sftp remote file copy (pull)
* certutil download (urlcache)
* certutil download (verifyctl)
* Windows - BITSAdmin BITS Download
* Windows - PowerShell Download
* OSTAP Worming Activity
* svchost writing a file to a UNC path
* Download a File with Windows Defender MpCmdRun.exe
* whois file download
* File Download via PowerShell
* File download with finger.exe on Windows
* Download a file with IMEWDBLD.exe
* Curl Download File
* Curl Upload File
* Download a file with Microsoft Connection Manager Auto-Download

### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 70

**ATT&CK-mapped resources for this (sub)technique:**4

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-07-001.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-07-001.yaml): 2 <code>unit_tests</code>
* [car/analytics/CAR-2021-05-005.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-05-005.yaml): 2 <code>unit_tests</code>
* [car/analytics/CAR-2021-05-006.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-05-006.yaml): 2 <code>unit_tests</code>
* [car/analytics/CAR-2021-05-007.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-05-007.yaml): 2 <code>unit_tests</code>

