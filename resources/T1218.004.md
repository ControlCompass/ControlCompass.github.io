# T1218.004: InstallUtil
**MITRE ATT&CK Tactic(s):** Defense Evasion

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1218/004)**
<blockquote>Adversaries may use InstallUtil to proxy execution of code through a trusted Windows utility. InstallUtil is a command-line utility that allows for installation and uninstallation of resources by executing specific installer components specified in .NET binaries. (Citation: MSDN InstallUtil) InstallUtil is digitally signed by Microsoft and located in the .NET directories on a Windows system: <code>C:\Windows\Microsoft.NET\Framework\v<version>\InstallUtil.exe</code> and <code>C:\Windows\Microsoft.NET\Framework64\v<version>\InstallUtil.exe</code>.

InstallUtil may also be used to bypass application control through use of attributes within the binary that execute the class decorated with the attribute <code>[System.ComponentModel.RunInstaller(true)]</code>. (Citation: LOLBAS Installutil)</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [no defensive relations yet](https://d3fend.mitre.org/techniques/d3f:nodefensiverelationsyet)

## Technical Controls (Detection Rules)
### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/windows/process_creation/proc_creation_win_possible_applocker_bypass.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_possible_applocker_bypass.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**7

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/windows_installutil_uninstall_option_with_network.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_installutil_uninstall_option_with_network.yml)
* [security_content/detections/endpoint/windows_installutil_remote_network_connection.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_installutil_remote_network_connection.yml)
* [security_content/detections/endpoint/windows_installutil_credential_theft.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_installutil_credential_theft.yml)
* [security_content/detections/endpoint/windows_installutil_uninstall_option.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_installutil_uninstall_option.yml)
* [security_content/detections/endpoint/windows_installutil_url_in_command_line.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_installutil_url_in_command_line.yml)
* [security_content/detections/endpoint/windows_dotnet_binary_in_non_standard_path.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_dotnet_binary_in_non_standard_path.yml)
* [security_content/detections/endpoint/windows_installutil_in_non_standard_path.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_installutil_in_non_standard_path.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**8

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1218.004/T1218.004.yaml):

* CheckIfInstallable method call
* InstallHelper method call
* InstallUtil class constructor method call
* InstallUtil Install method call
* InstallUtil Uninstall method call - /U variant
* InstallUtil Uninstall method call - '/installtype=notransaction /action=uninstall' variant
* InstallUtil HelpText method call
* InstallUtil evasive invocation

