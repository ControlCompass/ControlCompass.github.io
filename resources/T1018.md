# T1018: Remote System Discovery
**MITRE ATT&CK Tactic(s):** Discovery

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1018)**
<blockquote>Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  [Ping](https://attack.mitre.org/software/S0097) or <code>net view</code> using [Net](https://attack.mitre.org/software/S0039). Adversaries may also use local host files (ex: <code>C:\Windows\System32\Drivers\etc\hosts</code> or <code>/etc/hosts</code>) in order to discover the hostname to IP address mappings of remote systems. 
</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [no defensive relations yet](https://d3fend.mitre.org/techniques/d3f:nodefensiverelationsyet)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-04-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-04-002.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**14

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/linux/process_creation/proc_creation_lnx_remote_system_discovery.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_remote_system_discovery.yml)
* [sigma/rules/macos/process_creation/proc_creation_macos_remote_system_discovery.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_remote_system_discovery.yml)
* [sigma/rules/network/cisco/aaa/cisco_cli_discovery.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/network/cisco/aaa/cisco_cli_discovery.yml)
* [sigma/rules/windows/builtin/security/win_lolbas_execution_of_nltest.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_lolbas_execution_of_nltest.yml)
* [sigma/rules/windows/powershell/powershell_script/posh_ps_directorysearcher.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_directorysearcher.yml)
* [sigma/rules/windows/powershell/powershell_script/posh_ps_susp_get_adcomputer.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_susp_get_adcomputer.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_ad_find_discovery.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_ad_find_discovery.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_network_scan_loop.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_network_scan_loop.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_net_enum.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_net_enum.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_adfind.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_adfind.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_adidnsdump.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_adidnsdump.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_net_execution.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_net_execution.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_webshell_detection.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_detection.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_webshell_hacking.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_hacking.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**15

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/getadcomputer_with_powershell.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/getadcomputer_with_powershell.yml)
* [security_content/detections/endpoint/getdomaincontroller_with_powershell_script_block.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/getdomaincontroller_with_powershell_script_block.yml)
* [security_content/detections/endpoint/remote_system_discovery_with_adsisearcher.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/remote_system_discovery_with_adsisearcher.yml)
* [security_content/detections/endpoint/remote_system_discovery_with_wmic.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/remote_system_discovery_with_wmic.yml)
* [security_content/detections/endpoint/remote_system_discovery_with_net.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/remote_system_discovery_with_net.yml)
* [security_content/detections/endpoint/getdomaincontroller_with_powershell.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/getdomaincontroller_with_powershell.yml)
* [security_content/detections/endpoint/windows_adfind_exe.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_adfind_exe.yml)
* [security_content/detections/endpoint/domain_controller_discovery_with_nltest.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/domain_controller_discovery_with_nltest.yml)
* [security_content/detections/endpoint/domain_controller_discovery_with_wmic.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/domain_controller_discovery_with_wmic.yml)
* [security_content/detections/endpoint/getwmiobject_ds_computer_with_powershell_script_block.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/getwmiobject_ds_computer_with_powershell_script_block.yml)
* [security_content/detections/endpoint/remote_system_discovery_with_dsquery.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/remote_system_discovery_with_dsquery.yml)
* [security_content/detections/endpoint/getadcomputer_with_powershell_script_block.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/getadcomputer_with_powershell_script_block.yml)
* [security_content/detections/endpoint/getwmiobject_ds_computer_with_powershell.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/getwmiobject_ds_computer_with_powershell.yml)
* [security_content/detections/endpoint/getdomaincomputer_with_powershell_script_block.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/getdomaincomputer_with_powershell_script_block.yml)
* [security_content/detections/endpoint/getdomaincomputer_with_powershell.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/getdomaincomputer_with_powershell.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**19

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1018/T1018.yaml):

* Remote System Discovery - net
* Remote System Discovery - net group Domain Computers
* Remote System Discovery - nltest
* Remote System Discovery - ping sweep
* Remote System Discovery - arp
* Remote System Discovery - arp nix
* Remote System Discovery - sweep
* Remote System Discovery - nslookup
* Remote System Discovery - adidnsdump
* Adfind - Enumerate Active Directory Computer Objects
* Adfind - Enumerate Active Directory Domain Controller Objects
* Remote System Discovery - ip neighbour
* Remote System Discovery - ip route
* Remote System Discovery - ip tcp_metrics
* Enumerate domain computers within Active Directory using DirectorySearcher
* Enumerate Active Directory Computers with Get-AdComputer
* Enumerate Active Directory Computers with ADSISearcher
* Get-DomainController with PowerView
* Get-wmiobject to Enumerate Domain Controllers

### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 70

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-04-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-04-002.yaml): 1 <code>unit_tests</code>

