# T1526: Cloud Service Discovery
**MITRE ATT&CK Tactic(s):** Discovery

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1526)**
<blockquote>An adversary may attempt to enumerate the cloud services running on a system after gaining access. These methods can differ from platform-as-a-service (PaaS), to infrastructure-as-a-service (IaaS), or software-as-a-service (SaaS). Many services exist throughout the various cloud providers and can include Continuous Integration and Continuous Delivery (CI/CD), Lambda Functions, Azure AD, etc. 

Adversaries may attempt to discover information about the services enabled throughout the environment. Azure tools and APIs, such as the Azure AD Graph API and Azure Resource Manager API, can enumerate resources and services, including applications, management groups, resources and policy definitions, and their relationships that are accessible by an identity.(Citation: Azure - Resource Manager API)(Citation: Azure AD Graph API)

Stormspotter is an open source tool for enumerating and constructing a graph for Azure resources and services, and Pacu is an open source AWS exploitation framework that supports several methods for discovering cloud services.(Citation: Azure - Stormspotter)(Citation: GitHub Pacu)</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [no defensive relations yet](https://d3fend.mitre.org/techniques/d3f:nodefensiverelationsyet)

## Technical Controls (Detection Rules)
### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**4

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/cloud/aws_excessive_security_scanning.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_excessive_security_scanning.yml)
* [security_content/detections/cloud/kubernetes_scanner_image_pulling.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/kubernetes_scanner_image_pulling.yml)
* [security_content/detections/deprecated/gcp_kubernetes_cluster_scan_detection.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/gcp_kubernetes_cluster_scan_detection.yml)
* [security_content/detections/deprecated/kubernetes_azure_scan_fingerprint.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/kubernetes_azure_scan_fingerprint.yml)


## Offensive Security Tests
