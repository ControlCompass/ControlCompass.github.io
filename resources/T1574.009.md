# T1574.009: Path Interception by Unquoted Path
**MITRE ATT&CK Tactic(s):** Persistence, Privilege Escalation, Defense Evasion

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1574/009)**
<blockquote>Adversaries may execute their own malicious payloads by hijacking vulnerable file path references. Adversaries can take advantage of paths that lack surrounding quotations by placing an executable in a higher level directory within the path, so that Windows will choose the adversary's executable to launch.

Service paths (Citation: Microsoft CurrentControlSet Services) and shortcut paths may also be vulnerable to path interception if the path has one or more spaces and is not surrounded by quotation marks (e.g., <code>C:\unsafe path with space\program.exe</code> vs. <code>"C:\safe path with space\program.exe"</code>). (Citation: Help eliminate unquoted path) (stored in Windows Registry keys) An adversary can place an executable in a higher level directory of the path, and Windows will resolve that executable instead of the intended executable. For example, if the path in a shortcut is <code>C:\program files\myapp.exe</code>, an adversary may create a program at <code>C:\program.exe</code> that will be run instead of the intended program. (Citation: Windows Unquoted Services) (Citation: Windows Privilege Escalation Guide)

This technique can be used for persistence if executables are called on a regular basis, as well as privilege escalation if intercepted executables are started by a higher privileged process.</blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** May 23, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 7

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Local File Permissions](https://d3fend.mitre.org/technique/d3f:LocalFilePermissions)
* [Executable Allowlisting](https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting)
* [Executable Denylisting](https://d3fend.mitre.org/technique/d3f:ExecutableDenylisting)
* [Decoy File](https://d3fend.mitre.org/technique/d3f:DecoyFile)
* [File Analysis](https://d3fend.mitre.org/technique/d3f:FileAnalysis)
* [Dynamic Analysis](https://d3fend.mitre.org/technique/d3f:DynamicAnalysis)
* [Emulated File Analysis](https://d3fend.mitre.org/technique/d3f:EmulatedFileAnalysis)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** May 23, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[analytics](https://github.com/mitre-attack/car/blob/master/analytics)</code> folder:

* [Service Search Path Interception](https://github.com/mitre-attack/car/tree/master/analytics/CAR-2014-07-001.yaml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** May 23, 2022

**Total ATT&CK-mapped rules:** 1479

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[detections](https://github.com/splunk/security_content/tree/develop/detections)</code> folder:

* [endpoint](https://github.com/splunk/security_content/tree/develop/detections/endpoint/) / **[Detect Path Interception By Creation Of program exe](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_path_interception_by_creation_of_program_exe.yml)**


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** May 23, 2022

**Total ATT&CK-mapped tests:** 1262

**ATT&CK-mapped resources for this (sub)technique:** 3

The following unit tests mapped to this (sub)technique can be located in [the file here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1574.009/T1574.009.yaml):

* Execution of program.exe as service with unquoted service path
* Execution of program.exe as service with unquoted service path
* Execution of program.exe as service with unquoted service path

