# T1059.004: Unix Shell
**MITRE ATT&CK Tactic(s):** Execution

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1059/004)**
<blockquote>Adversaries may abuse Unix shell commands and scripts for execution. Unix shells are the primary command prompt on Linux and macOS systems, though many variations of the Unix shell exist (e.g. sh, bash, zsh, etc.) depending on the specific OS or distribution.(Citation: DieNet Bash)(Citation: Apple ZShell) Unix shells can control every aspect of a system, with certain commands requiring elevated privileges.

Unix shells also support scripts that enable sequential execution of commands as well as other typical programming operations such as conditionals and loops. Common uses of shell scripts include long or repetitive tasks, or the need to run the same set of commands on multiple systems.

Adversaries may abuse Unix shells to execute various commands or payloads. Interactive shells may be accessed through command and control channels or during lateral movement such as with [SSH](https://attack.mitre.org/techniques/T1021/004). Adversaries may also leverage shell scripts to deliver and execute multiple commands on victims or as part of payloads used for persistence.</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**7

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)
* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)
* [Dynamic Analysis](https://d3fend.mitre.org/techniques/d3f:DynamicAnalysis)
* [Emulated File Analysis](https://d3fend.mitre.org/techniques/d3f:EmulatedFileAnalysis)
* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)
* [Executable Allowlisting](https://d3fend.mitre.org/techniques/d3f:ExecutableAllowlisting)
* [Executable Denylisting](https://d3fend.mitre.org/techniques/d3f:ExecutableDenylisting)

## Technical Controls (Detection Rules)
### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**8

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/cloud/aws/aws_ec2_startup_script_change.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/aws_ec2_startup_script_change.yml)
* [sigma/rules/linux/auditd/lnx_auditd_susp_cmds.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_susp_cmds.yml)
* [sigma/rules/linux/builtin/lnx_apt_equationgroup_lnx.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/builtin/lnx_apt_equationgroup_lnx.yml)
* [sigma/rules/linux/builtin/lnx_shell_priv_esc_prep.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/builtin/lnx_shell_priv_esc_prep.yml)
* [sigma/rules/linux/builtin/lnx_shell_susp_commands.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/builtin/lnx_shell_susp_commands.yml)
* [sigma/rules/linux/builtin/lnx_shell_susp_rev_shells.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/builtin/lnx_shell_susp_rev_shells.yml)
* [sigma/rules/linux/builtin/lnx_susp_jexboss.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/builtin/lnx_susp_jexboss.yml)
* [sigma/rules/linux/process_creation/proc_creation_lnx_bpftrace_unsafe_option_usage.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_bpftrace_unsafe_option_usage.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/suspicious_linux_discovery_commands.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_linux_discovery_commands.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**4

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1059.004/T1059.004.yaml):

* Create and Execute Bash Shell Script
* Command-Line Interface
* Harvest SUID executable files
* LinEnum tool execution

