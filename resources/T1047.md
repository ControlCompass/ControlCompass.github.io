# T1047: Windows Management Instrumentation
**MITRE ATT&CK Tactic(s):** Execution

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1047)**
<blockquote>Adversaries may abuse Windows Management Instrumentation (WMI) to execute malicious commands and payloads. WMI is an administration feature that provides a uniform environment to access Windows system components. The WMI service enables both local and remote access, though the latter is facilitated by [Remote Services](https://attack.mitre.org/techniques/T1021) such as [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) (DCOM) and [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006) (WinRM). (Citation: MSDN WMI) Remote WMI over DCOM operates using port 135, whereas WMI over WinRM operates over port 5985 when using HTTP and 5986 for HTTPS. (Citation: MSDN WMI) (Citation: FireEye WMI 2015)

An adversary can use WMI to interact with local and remote systems and use it as a means to execute various behaviors, such as gathering information for Discovery as well as remote Execution of files as part of Lateral Movement. (Citation: FireEye WMI SANS 2015) (Citation: FireEye WMI 2015)</blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [no defensive relations yet](https://d3fend.mitre.org/techniques/d3f:nodefensiverelationsyet)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:** 3

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2014-11-007.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2014-11-007.yaml)
* [car/analytics/CAR-2014-12-001.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2014-12-001.yaml)
* [car/analytics/CAR-2016-03-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2016-03-002.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:** 36

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/application/rpc_firewall/rpc_firewall_remote_dcom_or_wmi.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/application/rpc_firewall/rpc_firewall_remote_dcom_or_wmi.yml)
* [sigma/rules/network/zeek/zeek_dce_rpc_mitre_bzar_execution.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/network/zeek/zeek_dce_rpc_mitre_bzar_execution.yml)
* [sigma/rules/windows/builtin/security/win_susp_wmi_login.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_susp_wmi_login.yml)
* [sigma/rules/windows/builtin/security/win_wmiprvse_wbemcomn_dll_hijack.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_wmiprvse_wbemcomn_dll_hijack.yml)
* [sigma/rules/windows/builtin/windefend/win_defender_psexec_wmi_asr.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/windefend/win_defender_psexec_wmi_asr.yml)
* [sigma/rules/windows/file_event/file_event_win_script_creation_by_office_using_file_ext.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_script_creation_by_office_using_file_ext.yml)
* [sigma/rules/windows/file_event/file_event_win_wmiprvse_wbemcomn_dll_hijack.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_wmiprvse_wbemcomn_dll_hijack.yml)
* [sigma/rules/windows/image_load/image_load_susp_winword_wmidll_load.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_susp_winword_wmidll_load.yml)
* [sigma/rules/windows/image_load/image_load_wmiprvse_wbemcomn_dll_hijack.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_wmiprvse_wbemcomn_dll_hijack.yml)
* [sigma/rules/windows/image_load/image_load_wmi_module_load.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_wmi_module_load.yml)
* [sigma/rules/windows/pipe_created/pipe_created_susp_wmi_consumer_namedpipe.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/pipe_created/pipe_created_susp_wmi_consumer_namedpipe.yml)
* [sigma/rules/windows/powershell/powershell_script/posh_ps_wmimplant.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_wmimplant.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_unc2452_ps.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_unc2452_ps.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_bypass_squiblytwo.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_bypass_squiblytwo.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_crime_maze_ransomware.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_crime_maze_ransomware.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_html_help_spawn.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_html_help_spawn.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_impacket_lateralization.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_impacket_lateralization.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_lolbins_by_office_applications.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbins_by_office_applications.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_lolbins_with_wmiprvse_parent_process.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbins_with_wmiprvse_parent_process.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_mal_blue_mockingbird.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mal_blue_mockingbird.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_office_applications_spawning_wmi_commandline.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_applications_spawning_wmi_commandline.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_office_from_proxy_executing_regsvr32_payload.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_from_proxy_executing_regsvr32_payload.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_office_from_proxy_executing_regsvr32_payload2.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_from_proxy_executing_regsvr32_payload2.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_office_spawning_wmi_commandline.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_office_spawning_wmi_commandline.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_script_event_consumer_spawn.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_script_event_consumer_spawn.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_crackmapexec_execution.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_crackmapexec_execution.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_wmic_proc_create_rundll32.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_wmic_proc_create_rundll32.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_wmi_execution.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_wmi_execution.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_wmic_reconnaissance.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_reconnaissance.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_wmic_remote_command.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_remote_command.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_wmic_remote_service.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_remote_service.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_wmic_remove_application.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmic_remove_application.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_wmiprvse_spawning_process.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmiprvse_spawning_process.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_wmi_spwns_powershell.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wmi_spwns_powershell.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_mal_blue_mockingbird.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_mal_blue_mockingbird.yml)
* [sigma/rules/windows/wmi_event/sysmon_wmi_susp_encoded_scripts.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/wmi_event/sysmon_wmi_susp_encoded_scripts.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:** 11

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/deprecated/ssa___recon_and_use_operating_system_elements_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___recon_and_use_operating_system_elements_via_powersploit_modules.yml)
* [security_content/detections/endpoint/script_execution_via_wmi.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/script_execution_via_wmi.yml)
* [security_content/detections/endpoint/remote_process_instantiation_via_wmi.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/remote_process_instantiation_via_wmi.yml)
* [security_content/detections/endpoint/impacket_lateral_movement_commandline_parameters.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/impacket_lateral_movement_commandline_parameters.yml)
* [security_content/detections/endpoint/possible_lateral_movement_powershell_spawn.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/possible_lateral_movement_powershell_spawn.yml)
* [security_content/detections/endpoint/remote_process_instantiation_via_wmi_and_powershell_script_block.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/remote_process_instantiation_via_wmi_and_powershell_script_block.yml)
* [security_content/detections/endpoint/windows_wmi_process_call_create.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_wmi_process_call_create.yml)
* [security_content/detections/endpoint/wmiprsve_exe_lolbas_execution_process_spawn.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/wmiprsve_exe_lolbas_execution_process_spawn.yml)
* [security_content/detections/endpoint/remote_process_instantiation_via_wmi_and_powershell.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/remote_process_instantiation_via_wmi_and_powershell.yml)
* [security_content/detections/endpoint/remote_wmi_command_attempt.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/remote_wmi_command_attempt.yml)
* [security_content/detections/endpoint/process_execution_via_wmi.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/process_execution_via_wmi.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:** 10

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1047/T1047.yaml):

* WMI Reconnaissance Users
* WMI Reconnaissance Processes
* WMI Reconnaissance Software
* WMI Reconnaissance List Remote Services
* WMI Execute Local Process
* WMI Execute Remote Process
* Create a Process using WMI Query and an Encoded Command
* Create a Process using obfuscated Win32_Process
* WMI Execute rundll32
* Application uninstall using WMIC

