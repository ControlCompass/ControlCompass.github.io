# T1071: Application Layer Protocol
**MITRE ATT&CK Tactic(s):** Command and Control

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1071)**
<blockquote>Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. 

Adversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP. </blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 19

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Client-server Payload Profiling](https://d3fend.mitre.org/techniques/d3f:Client-serverPayloadProfiling)
* [Per Host Download-Upload Ratio Analysis](https://d3fend.mitre.org/techniques/d3f:PerHostDownload-UploadRatioAnalysis)
* [Network Traffic Community Deviation](https://d3fend.mitre.org/techniques/d3f:NetworkTrafficCommunityDeviation)
* [Certificate Analysis](https://d3fend.mitre.org/techniques/d3f:CertificateAnalysis)
* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)
* [Protocol Metadata Anomaly Detection](https://d3fend.mitre.org/techniques/d3f:ProtocolMetadataAnomalyDetection)
* [Relay Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:RelayPatternAnalysis)
* [File Carving](https://d3fend.mitre.org/techniques/d3f:FileCarving)
* [Remote Terminal Session Detection](https://d3fend.mitre.org/techniques/d3f:RemoteTerminalSessionDetection)
* [DNS Traffic Analysis](https://d3fend.mitre.org/techniques/d3f:DNSTrafficAnalysis)
* [User Geolocation Logon Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:UserGeolocationLogonPatternAnalysis)
* [Inbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:InboundTrafficFiltering)
* [Outbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:OutboundTrafficFiltering)
* [DNS Denylisting](https://d3fend.mitre.org/techniques/d3f:DNSDenylisting)
* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)
* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)
* [DNS Allowlisting](https://d3fend.mitre.org/techniques/d3f:DNSAllowlisting)
* [Reverse Resolution IP Denylisting](https://d3fend.mitre.org/techniques/d3f:ReverseResolutionIPDenylisting)
* [Forward Resolution Domain Denylisting](https://d3fend.mitre.org/techniques/d3f:ForwardResolutionDomainDenylisting)

## Technical Controls (Detection Rules)
### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:** 6

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/windows/builtin/dns_server/win_apt_gallium.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/dns_server/win_apt_gallium.yml)
* [sigma/rules/windows/image_load/image_load_silenttrinity_stage_use.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_silenttrinity_stage_use.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_gallium.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_gallium.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_gallium_sha1.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_gallium_sha1.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_dnscat2_powershell_implementation.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dnscat2_powershell_implementation.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_silenttrinity_stage_use.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_silenttrinity_stage_use.yml)


## Offensive Security Tests
