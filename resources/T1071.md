# T1071: Application Layer Protocol
**MITRE ATT&CK Tactic(s):** Command and Control

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1071)**
<blockquote>Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. 

Adversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS. For connections that occur internally within an enclave (such as those between a proxy or pivot node and other nodes), commonly used protocols are SMB, SSH, or RDP. </blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 19

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Client-server Payload Profiling](https://d3fend.mitre.org/techniques/d3f:Client-serverPayloadProfiling)
* [Per Host Download-Upload Ratio Analysis](https://d3fend.mitre.org/techniques/d3f:PerHostDownload-UploadRatioAnalysis)
* [Network Traffic Community Deviation](https://d3fend.mitre.org/techniques/d3f:NetworkTrafficCommunityDeviation)
* [Certificate Analysis](https://d3fend.mitre.org/techniques/d3f:CertificateAnalysis)
* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)
* [Protocol Metadata Anomaly Detection](https://d3fend.mitre.org/techniques/d3f:ProtocolMetadataAnomalyDetection)
* [Relay Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:RelayPatternAnalysis)
* [File Carving](https://d3fend.mitre.org/techniques/d3f:FileCarving)
* [Remote Terminal Session Detection](https://d3fend.mitre.org/techniques/d3f:RemoteTerminalSessionDetection)
* [DNS Traffic Analysis](https://d3fend.mitre.org/techniques/d3f:DNSTrafficAnalysis)
* [User Geolocation Logon Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:UserGeolocationLogonPatternAnalysis)
* [Inbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:InboundTrafficFiltering)
* [Outbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:OutboundTrafficFiltering)
* [DNS Denylisting](https://d3fend.mitre.org/techniques/d3f:DNSDenylisting)
* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)
* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)
* [DNS Allowlisting](https://d3fend.mitre.org/techniques/d3f:DNSAllowlisting)
* [Reverse Resolution IP Denylisting](https://d3fend.mitre.org/techniques/d3f:ReverseResolutionIPDenylisting)
* [Forward Resolution Domain Denylisting](https://d3fend.mitre.org/techniques/d3f:ForwardResolutionDomainDenylisting)

## Technical Controls (Detection Rules)
### [Microsoft Sentinel and Microsoft 365 Defender repository](https://github.com/Azure/Azure-Sentinel)
**Last accessed:** May 19, 2022

**Total ATT&CK-mapped rules:** 383

**ATT&CK-mapped resources for this (sub)technique:** 12

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[Detections](https://github.com/Azure/Azure-Sentinel/tree/master/Detections)</code> folder:

* [ASimNetworkSession](https://github.com/Azure/Azure-Sentinel/tree/master/Detections/ASimNetworkSession/) / **[Potential beaconing activity (ASIM Network Session schema)](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/ASimNetworkSession/PossibleBeaconingActivity.yaml)**
* [AzureFirewall](https://github.com/Azure/Azure-Sentinel/tree/master/Detections/AzureFirewall/) / **[Several deny actions registered](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/AzureFirewall/SeveralDenyActionsRegistered.yaml)**
* [CommonSecurityLog](https://github.com/Azure/Azure-Sentinel/tree/master/Detections/CommonSecurityLog/) / **[Fortinet - Beacon pattern detected](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/CommonSecurityLog/Fortinet-NetworkBeaconPattern.yaml)**
* [CommonSecurityLog](https://github.com/Azure/Azure-Sentinel/tree/master/Detections/CommonSecurityLog/) / **[Palo Alto - potential beaconing detected](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/CommonSecurityLog/PaloAlto-NetworkBeaconing.yaml)**
* [CommonSecurityLog](https://github.com/Azure/Azure-Sentinel/tree/master/Detections/CommonSecurityLog/) / **[Request for single resource on domain](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/CommonSecurityLog/Zscaler-LowVolumeDomainRequests.yaml)**
* [MultipleDataSources](https://github.com/Azure/Azure-Sentinel/tree/master/Detections/MultipleDataSources/) / **[Linked Malicious Storage Artifacts](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/AdditionalFilesUploadedByActor.yaml)**
* [MultipleDataSources](https://github.com/Azure/Azure-Sentinel/tree/master/Detections/MultipleDataSources/) / **[Known PHOSPHORUS group domains/IP - October 2020](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/KnownPHOSPHORUSDomainsIP-October2020.yaml)**
* [MultipleDataSources](https://github.com/Azure/Azure-Sentinel/tree/master/Detections/MultipleDataSources/) / **[Malformed user agent](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/MalformedUserAgents.yaml)**
* [MultipleDataSources](https://github.com/Azure/Azure-Sentinel/tree/master/Detections/MultipleDataSources/) / **[New UserAgent observed in last 24 hours](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/NewUserAgentLast24h.yaml)**
* [MultipleDataSources](https://github.com/Azure/Azure-Sentinel/tree/master/Detections/MultipleDataSources/) / **[Known NICKEL domains and hashes](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/NICKELIOCsNov2021.yaml)**
* [MultipleDataSources](https://github.com/Azure/Azure-Sentinel/tree/master/Detections/MultipleDataSources/) / **[Known Phosphorus group domains/IP](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/PHOSPHORUSMarch2019IOCs.yaml)**
* [MultipleDataSources](https://github.com/Azure/Azure-Sentinel/tree/master/Detections/MultipleDataSources/) / **[Known STRONTIUM group domains - July 2019](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/STRONTIUMJuly2019IOCs.yaml)**

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** May 19, 2022

**Total ATT&CK-mapped rules:** 2356

**ATT&CK-mapped resources for this (sub)technique:** 6

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[rules](https://github.com/SigmaHQ/sigma/tree/master/rules)</code> folder:

* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [builtin](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/) / [dns_server](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/dns_server/) / **[GALLIUM Artefacts](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/dns_server/win_apt_gallium.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [image_load](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/) / **[SILENTTRINITY Stager Execution](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_silenttrinity_stage_use.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [process_creation](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/) / **[GALLIUM Artefacts](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_gallium.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [process_creation](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/) / **[GALLIUM Artefacts](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_gallium_sha1.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [process_creation](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/) / **[DNSCat2 Powershell Implementation Detection Via Process Creation](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dnscat2_powershell_implementation.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [process_creation](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/) / **[SILENTTRINITY Stager Execution](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_silenttrinity_stage_use.yml)**

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** May 19, 2022

**Total ATT&CK-mapped rules:** 1478

**ATT&CK-mapped resources for this (sub)technique:** 4

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[detections](https://github.com/splunk/security_content/tree/develop/detections)</code> folder:

* [experimental](https://github.com/splunk/security_content/tree/develop/detections/experimental/) / [network](https://github.com/splunk/security_content/tree/develop/detections/experimental/network/) / **[Detect Outbound SMB Traffic](https://github.com/splunk/security_content/blob/develop/detections/experimental/network/detect_outbound_smb_traffic.yml)**
* [experimental](https://github.com/splunk/security_content/tree/develop/detections/experimental/) / [network](https://github.com/splunk/security_content/tree/develop/detections/experimental/network/) / **[DNS Query Length Outliers - MLTK](https://github.com/splunk/security_content/blob/develop/detections/experimental/network/dns_query_length_outliers___mltk.yml)**
* [experimental](https://github.com/splunk/security_content/tree/develop/detections/experimental/) / [network](https://github.com/splunk/security_content/tree/develop/detections/experimental/network/) / **[Excessive DNS Failures](https://github.com/splunk/security_content/blob/develop/detections/experimental/network/excessive_dns_failures.yml)**
* [experimental](https://github.com/splunk/security_content/tree/develop/detections/experimental/) / [network](https://github.com/splunk/security_content/tree/develop/detections/experimental/network/) / **[TOR Traffic](https://github.com/splunk/security_content/blob/develop/detections/experimental/network/tor_traffic.yml)**


## Offensive Security Tests
