# T1078: Valid Accounts
**MITRE ATT&CK Tactic(s):** Defense Evasion, Persistence, Privilege Escalation, Initial Access

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1078)**
<blockquote>Adversaries may obtain and abuse credentials of existing accounts as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Compromised credentials may be used to bypass access controls placed on various resources on systems within the network and may even be used for persistent access to remote systems and externally available services, such as VPNs, Outlook Web Access and remote desktop. Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network. Adversaries may choose not to use malware or tools in conjunction with the legitimate access those credentials provide to make it harder to detect their presence.

The overlap of permissions for local, domain, and cloud accounts across a network of systems is of concern because the adversary may be able to pivot across accounts and systems to reach a high level of access (i.e., domain or enterprise administrator) to bypass access controls set within the enterprise. (Citation: TechNet Credential Theft)</blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 12

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Authorization Event Thresholding](https://d3fend.mitre.org/techniques/d3f:AuthorizationEventThresholding)
* [Local Account Monitoring](https://d3fend.mitre.org/techniques/d3f:LocalAccountMonitoring)
* [Resource Access Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:ResourceAccessPatternAnalysis)
* [Domain Account Monitoring](https://d3fend.mitre.org/techniques/d3f:DomainAccountMonitoring)
* [Authentication Event Thresholding](https://d3fend.mitre.org/techniques/d3f:AuthenticationEventThresholding)
* [User Account Permissions](https://d3fend.mitre.org/techniques/d3f:UserAccountPermissions)
* [Strong Password Policy](https://d3fend.mitre.org/techniques/d3f:StrongPasswordPolicy)
* [Multi-factor Authentication](https://d3fend.mitre.org/techniques/d3f:Multi-factorAuthentication)
* [Job Function Access Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:JobFunctionAccessPatternAnalysis)
* [One-time Password](https://d3fend.mitre.org/techniques/d3f:One-timePassword)
* [Session Duration Analysis](https://d3fend.mitre.org/techniques/d3f:SessionDurationAnalysis)
* [Account Locking](https://d3fend.mitre.org/techniques/d3f:AccountLocking)

## Technical Controls (Detection Rules)
### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:** 19

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/cloud/aws/aws_lambda_function_created_or_invoked.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/aws_lambda_function_created_or_invoked.yml)
* [sigma/rules/cloud/aws/aws_suspicious_saml_activity.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/aws_suspicious_saml_activity.yml)
* [sigma/rules/cloud/azure/azure_federation_modified.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/azure/azure_federation_modified.yml)
* [sigma/rules/cloud/azure/azure_kubernetes_admission_controller.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/azure/azure_kubernetes_admission_controller.yml)
* [sigma/rules/cloud/azure/azure_login_to_disabled_account.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/azure/azure_login_to_disabled_account.yml)
* [sigma/rules/cloud/azure/azure_subscription_permissions_elevation_via_activitylogs.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/azure/azure_subscription_permissions_elevation_via_activitylogs.yml)
* [sigma/rules/cloud/azure/azure_subscription_permissions_elevation_via_auditlogs.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/azure/azure_subscription_permissions_elevation_via_auditlogs.yml)
* [sigma/rules/cloud/azure/azure_unusual_authentication_interruption.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/azure/azure_unusual_authentication_interruption.yml)
* [sigma/rules/cloud/gcp/gcp_kubernetes_admission_controller.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/gcp/gcp_kubernetes_admission_controller.yml)
* [sigma/rules/cloud/m365/microsoft365_impossible_travel_activity.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/m365/microsoft365_impossible_travel_activity.yml)
* [sigma/rules/cloud/m365/microsoft365_logon_from_risky_ip_address.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/m365/microsoft365_logon_from_risky_ip_address.yml)
* [sigma/rules/windows/builtin/security/win_susp_failed_logons_single_source.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_susp_failed_logons_single_source.yml)
* [sigma/rules/windows/builtin/security/win_susp_failed_logons_single_source2.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_susp_failed_logons_single_source2.yml)
* [sigma/rules/windows/builtin/security/win_susp_failed_logon_reasons.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_susp_failed_logon_reasons.yml)
* [sigma/rules/windows/builtin/security/win_susp_failed_logon_source.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_susp_failed_logon_source.yml)
* [sigma/rules/windows/builtin/security/win_susp_interactive_logons.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_susp_interactive_logons.yml)
* [sigma/rules/windows/builtin/security/win_susp_logon_explicit_credentials.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_susp_logon_explicit_credentials.yml)
* [sigma/rules/windows/builtin/security/win_user_added_to_local_administrators.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_user_added_to_local_administrators.yml)
* [sigma/rules/windows/powershell/powershell_module/posh_pm_suspicious_reset_computermachinepassword.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_module/posh_pm_suspicious_reset_computermachinepassword.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:** 36

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/cloud/abnormally_high_number_of_cloud_infrastructure_api_calls.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/abnormally_high_number_of_cloud_infrastructure_api_calls.yml)
* [security_content/detections/cloud/cloud_provisioning_from_previously_unseen_city.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/cloud_provisioning_from_previously_unseen_city.yml)
* [security_content/detections/cloud/cloud_provisioning_from_previously_unseen_country.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/cloud_provisioning_from_previously_unseen_country.yml)
* [security_content/detections/cloud/aws_setdefaultpolicyversion.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_setdefaultpolicyversion.yml)
* [security_content/detections/cloud/cloud_provisioning_from_previously_unseen_ip_address.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/cloud_provisioning_from_previously_unseen_ip_address.yml)
* [security_content/detections/cloud/aws_saml_access_by_provider_user_and_principal.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_saml_access_by_provider_user_and_principal.yml)
* [security_content/detections/cloud/aws_saml_update_identity_provider.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_saml_update_identity_provider.yml)
* [security_content/detections/cloud/cloud_api_calls_from_previously_unseen_user_roles.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/cloud_api_calls_from_previously_unseen_user_roles.yml)
* [security_content/detections/cloud/aws_create_policy_version_to_allow_all_resources.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_create_policy_version_to_allow_all_resources.yml)
* [security_content/detections/cloud/cloud_instance_modified_with_previously_unseen_user.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/cloud_instance_modified_with_previously_unseen_user.yml)
* [security_content/detections/cloud/abnormally_high_number_of_cloud_security_group_api_calls.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/abnormally_high_number_of_cloud_security_group_api_calls.yml)
* [security_content/detections/cloud/cloud_provisioning_from_previously_unseen_region.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/cloud_provisioning_from_previously_unseen_region.yml)
* [security_content/detections/cloud/cloud_compute_instance_created_by_previously_unseen_user.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/cloud_compute_instance_created_by_previously_unseen_user.yml)
* [security_content/detections/deprecated/ssa___recon_access_and_persistence_opportunities_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___recon_access_and_persistence_opportunities_via_powersploit_modules.yml)
* [security_content/detections/deprecated/ssa___setting_credentials_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___setting_credentials_via_powersploit_modules.yml)
* [security_content/detections/deprecated/ssa___applying_stolen_credentials_via_mimikatz_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___applying_stolen_credentials_via_mimikatz_modules.yml)
* [security_content/detections/deprecated/ssa___probing_access_with_stolen_credentials_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___probing_access_with_stolen_credentials_via_powersploit_modules.yml)
* [security_content/detections/deprecated/ssa___illegal_account_enable_disable_via_dsinternals_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___illegal_account_enable_disable_via_dsinternals_modules.yml)
* [security_content/detections/deprecated/ssa___recon_credential_stores_and_services_via_mimikatz_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___recon_credential_stores_and_services_via_mimikatz_modules.yml)
* [security_content/detections/deprecated/ssa___recon_and_use_accounts_groups_via_mimikatz_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___recon_and_use_accounts_groups_via_mimikatz_modules.yml)
* [security_content/detections/deprecated/ssa___applying_stolen_credentials_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___applying_stolen_credentials_via_powersploit_modules.yml)
* [security_content/detections/deprecated/gcp_detect_accounts_with_high_risk_roles_by_project.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/gcp_detect_accounts_with_high_risk_roles_by_project.yml)
* [security_content/detections/deprecated/ssa___assess_credential_strength_via_dsinternals_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___assess_credential_strength_via_dsinternals_modules.yml)
* [security_content/detections/deprecated/gcp_detect_high_risk_permissions_by_resource_and_account.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/gcp_detect_high_risk_permissions_by_resource_and_account.yml)
* [security_content/detections/deprecated/ssa___recon_privilege_escalation_opportunities_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___recon_privilege_escalation_opportunities_via_powersploit_modules.yml)
* [security_content/detections/deprecated/ssa___recon_and_use_accounts_groups_policies_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___recon_and_use_accounts_groups_policies_via_powersploit_modules.yml)
* [security_content/detections/deprecated/gcp_detect_oauth_token_abuse.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/gcp_detect_oauth_token_abuse.yml)
* [security_content/detections/deprecated/ssa___setting_credentials_via_mimikatz_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___setting_credentials_via_mimikatz_modules.yml)
* [security_content/detections/deprecated/web_fraud___anomalous_user_clickspeed.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/web_fraud___anomalous_user_clickspeed.yml)
* [security_content/detections/deprecated/ssa___setting_credentials_via_dsinternals_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___setting_credentials_via_dsinternals_modules.yml)
* [security_content/detections/endpoint/detect_excessive_account_lockouts_from_endpoint.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_excessive_account_lockouts_from_endpoint.yml)
* [security_content/detections/endpoint/suspicious_ticket_granting_ticket_request.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_ticket_granting_ticket_request.yml)
* [security_content/detections/endpoint/ssa___disable_net_user_account.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ssa___disable_net_user_account.yml)
* [security_content/detections/endpoint/detect_excessive_user_account_lockouts.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_excessive_user_account_lockouts.yml)
* [security_content/detections/endpoint/suspicious_kerberos_service_ticket_request.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_kerberos_service_ticket_request.yml)
* [security_content/detections/endpoint/suspicious_computer_account_name_change.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_computer_account_name_change.yml)


## Offensive Security Tests
### [Stratus Red Team](https://github.com/DataDog/stratus-red-team/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped tests:** 21

**ATT&CK-mapped resources for this (sub)technique:** 2

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://stratus-red-team.cloud/attack-techniques/):

* [aws.persistence.iam-backdoor-role](https://stratus-red-team.cloud/attack-techniques/aws/aws.persistence.iam-backdoor-role/)
* [aws.persistence.iam-create-user-login-profile](https://stratus-red-team.cloud/attack-techniques/aws/aws.persistence.iam-create-user-login-profile/)

