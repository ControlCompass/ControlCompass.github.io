# T1068: Exploitation for Privilege Escalation
**MITRE ATT&CK Tactic(s):** Privilege Escalation

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1068)**
<blockquote>Adversaries may exploit software vulnerabilities in an attempt to elevate privileges. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Security constructs such as permission levels will often hinder access to information and use of certain techniques, so adversaries will likely need to perform privilege escalation to include use of software exploitation to circumvent those restrictions.

When initially gaining access to a system, an adversary may be operating within a lower privileged process which will prevent them from accessing certain resources on the system. Vulnerabilities may exist, usually in operating system components and software commonly running at higher permissions, that can be exploited to gain higher levels of access on the system. This could enable someone to move from unprivileged or user level permissions to SYSTEM or root permissions depending on the component that is vulnerable. This could also enable an adversary to move from a virtualized environment, such as within a virtual machine or container, onto the underlying host. This may be a necessary step for an adversary compromising an endpoint system that has been properly configured and limits other privilege escalation methods.

Adversaries may bring a signed vulnerable driver onto a compromised machine so that they can exploit the vulnerability to execute code in kernel mode. This process is sometimes referred to as Bring Your Own Vulnerable Driver (BYOVD).(Citation: ESET InvisiMole June 2020)(Citation: Unit42 AcidBox June 2020) Adversaries may include the vulnerable driver with files delivered during Initial Access or download it to a compromised system via [Ingress Tool Transfer](https://attack.mitre.org/techniques/T1105) or [Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570).</blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 6

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Process Segment Execution Prevention](https://d3fend.mitre.org/techniques/d3f:ProcessSegmentExecutionPrevention)
* [Segment Address Offset Randomization](https://d3fend.mitre.org/techniques/d3f:SegmentAddressOffsetRandomization)
* [Stack Frame Canary Validation](https://d3fend.mitre.org/techniques/d3f:StackFrameCanaryValidation)
* [Process Code Segment Verification](https://d3fend.mitre.org/techniques/d3f:ProcessCodeSegmentVerification)
* [Shadow Stack Comparisons](https://d3fend.mitre.org/techniques/d3f:ShadowStackComparisons)
* [Memory Boundary Tracking](https://d3fend.mitre.org/techniques/d3f:MemoryBoundaryTracking)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2021-01-004.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-01-004.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:** 20

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/linux/auditd/lnx_auditd_coinminer.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_coinminer.yml)
* [sigma/rules/linux/auditd/lnx_auditd_cve_2021_3156_sudo_buffer_overflow.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_cve_2021_3156_sudo_buffer_overflow.yml)
* [sigma/rules/linux/auditd/lnx_auditd_cve_2021_3156_sudo_buffer_overflow_brutforce.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_cve_2021_3156_sudo_buffer_overflow_brutforce.yml)
* [sigma/rules/linux/auditd/lnx_auditd_cve_2021_4034.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_cve_2021_4034.yml)
* [sigma/rules/linux/auditd/lnx_auditd_omigod_scx_runasprovider_executeshellcommand.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_omigod_scx_runasprovider_executeshellcommand.yml)
* [sigma/rules/linux/builtin/lnx_buffer_overflows.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/builtin/lnx_buffer_overflows.yml)
* [sigma/rules/linux/builtin/lnx_sudo_cve_2019_14287.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/builtin/lnx_sudo_cve_2019_14287.yml)
* [sigma/rules/linux/builtin/lnx_sudo_cve_2019_14287_user.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/builtin/lnx_sudo_cve_2019_14287_user.yml)
* [sigma/rules/linux/process_creation/proc_creation_lnx_omigod_scx_runasprovider_executescript.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_omigod_scx_runasprovider_executescript.yml)
* [sigma/rules/linux/process_creation/proc_creation_lnx_omigod_scx_runasprovider_executeshellcommand.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_omigod_scx_runasprovider_executeshellcommand.yml)
* [sigma/rules/network/zeek/zeek_http_omigod_no_auth_rce.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/network/zeek/zeek_http_omigod_no_auth_rce.yml)
* [sigma/rules/windows/builtin/application/win_audit_cve.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/win_audit_cve.yml)
* [sigma/rules/windows/builtin/security/win_privesc_cve_2020_1472.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_privesc_cve_2020_1472.yml)
* [sigma/rules/windows/file_event/file_event_win_cve_2021_41379_msi_lpe.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_cve_2021_41379_msi_lpe.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_hurricane_panda.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_hurricane_panda.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_exploit_cve_2019_1378.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_exploit_cve_2019_1378.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_exploit_cve_2019_1388.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_exploit_cve_2019_1388.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_exploit_lpe_cve_2021_41379.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_exploit_lpe_cve_2021_41379.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_exploit_systemnightmare.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_exploit_systemnightmare.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_spoolsv_child_processes.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_spoolsv_child_processes.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:** 10

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/deprecated/ssa___recon_access_and_persistence_opportunities_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___recon_access_and_persistence_opportunities_via_powersploit_modules.yml)
* [security_content/detections/deprecated/ssa___setting_credentials_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___setting_credentials_via_powersploit_modules.yml)
* [security_content/detections/deprecated/ssa___applying_stolen_credentials_via_mimikatz_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___applying_stolen_credentials_via_mimikatz_modules.yml)
* [security_content/detections/deprecated/ssa___recon_credential_stores_and_services_via_mimikatz_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___recon_credential_stores_and_services_via_mimikatz_modules.yml)
* [security_content/detections/deprecated/ssa___applying_stolen_credentials_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___applying_stolen_credentials_via_powersploit_modules.yml)
* [security_content/detections/deprecated/ssa___recon_privilege_escalation_opportunities_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___recon_privilege_escalation_opportunities_via_powersploit_modules.yml)
* [security_content/detections/deprecated/ssa___setting_credentials_via_mimikatz_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___setting_credentials_via_mimikatz_modules.yml)
* [security_content/detections/deprecated/ssa___setting_credentials_via_dsinternals_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___setting_credentials_via_dsinternals_modules.yml)
* [security_content/detections/endpoint/spoolsv_suspicious_process_access.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/spoolsv_suspicious_process_access.yml)
* [security_content/detections/endpoint/linux_pkexec_privilege_escalation.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/linux_pkexec_privilege_escalation.yml)


## Offensive Security Tests
