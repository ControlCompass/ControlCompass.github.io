# T1087.001: Local Account
**MITRE ATT&CK Tactic(s):** Discovery

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1087/001)**
<blockquote>Adversaries may attempt to get a listing of local system accounts. This information can help adversaries determine which local accounts exist on a system to aid in follow-on behavior.

Commands such as <code>net user</code> and <code>net localgroup</code> of the [Net](https://attack.mitre.org/software/S0039) utility and <code>id</code> and <code>groups</code>on macOS and Linux can list local users and groups. On Linux, local users can also be enumerated through the use of the <code>/etc/passwd</code> file. On macOS the <code>dscl . list /Users</code> command can be used to enumerate local accounts.</blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 6

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Strong Password Policy](https://d3fend.mitre.org/techniques/d3f:StrongPasswordPolicy)
* [User Account Permissions](https://d3fend.mitre.org/techniques/d3f:UserAccountPermissions)
* [Multi-factor Authentication](https://d3fend.mitre.org/techniques/d3f:Multi-factorAuthentication)
* [One-time Password](https://d3fend.mitre.org/techniques/d3f:One-timePassword)
* [Local Account Monitoring](https://d3fend.mitre.org/techniques/d3f:LocalAccountMonitoring)
* [Account Locking](https://d3fend.mitre.org/techniques/d3f:AccountLocking)

## Technical Controls (Detection Rules)
### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:** 9

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/linux/process_creation/proc_creation_lnx_local_account.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_local_account.yml)
* [sigma/rules/macos/process_creation/proc_creation_macos_local_account.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_local_account.yml)
* [sigma/rules/network/cisco/aaa/cisco_cli_collect_data.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/network/cisco/aaa/cisco_cli_collect_data.yml)
* [sigma/rules/windows/powershell/powershell_script/posh_ps_azurehound_commands.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_azurehound_commands.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_hack_bloodhound.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hack_bloodhound.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_local_system_owner_account_discovery.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_local_system_owner_account_discovery.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_net_execution.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_net_execution.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_psloglist.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_psloglist.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_recon_activity.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_recon_activity.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:** 11

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/getlocaluser_with_powershell_script_block.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/getlocaluser_with_powershell_script_block.yml)
* [security_content/detections/endpoint/getwmiobject_user_account_with_powershell.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/getwmiobject_user_account_with_powershell.yml)
* [security_content/detections/endpoint/detect_sharphound_command_line_arguments.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_sharphound_command_line_arguments.yml)
* [security_content/detections/endpoint/detect_sharphound_usage.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_sharphound_usage.yml)
* [security_content/detections/endpoint/local_account_discovery_with_net.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/local_account_discovery_with_net.yml)
* [security_content/detections/endpoint/detect_sharphound_file_modifications.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_sharphound_file_modifications.yml)
* [security_content/detections/endpoint/detect_azurehound_command_line_arguments.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_azurehound_command_line_arguments.yml)
* [security_content/detections/endpoint/getlocaluser_with_powershell.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/getlocaluser_with_powershell.yml)
* [security_content/detections/endpoint/local_account_discovery_with_wmic.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/local_account_discovery_with_wmic.yml)
* [security_content/detections/endpoint/getwmiobject_user_account_with_powershell_script_block.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/getwmiobject_user_account_with_powershell_script_block.yml)
* [security_content/detections/endpoint/detect_azurehound_file_modifications.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_azurehound_file_modifications.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:** 10

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1087.001/T1087.001.yaml):

* Enumerate all accounts (Local)
* View sudoers access
* View accounts with UID 0
* List opened files by user
* Show if a user account has ever logged in remotely
* Enumerate users and groups
* Enumerate users and groups
* Enumerate all accounts on Windows (Local)
* Enumerate all accounts via PowerShell (Local)
* Enumerate logged on users via CMD (Local)

