# T1078.004: Cloud Accounts
**MITRE ATT&CK Tactic(s):** Defense Evasion, Persistence, Privilege Escalation, Initial Access

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1078/004)**
<blockquote>Adversaries may obtain and abuse credentials of a cloud account as a means of gaining Initial Access, Persistence, Privilege Escalation, or Defense Evasion. Cloud accounts are those created and configured by an organization for use by users, remote support, services, or for administration of resources within a cloud service provider or SaaS application. In some cases, cloud accounts may be federated with traditional identity management system, such as Window Active Directory. (Citation: AWS Identity Federation)(Citation: Google Federating GC)(Citation: Microsoft Deploying AD Federation)

Compromised credentials for cloud accounts can be used to harvest sensitive data from online storage accounts and databases. Access to cloud accounts can also be abused to gain Initial Access to a network by abusing a [Trusted Relationship](https://attack.mitre.org/techniques/T1199). Similar to [Domain Accounts](https://attack.mitre.org/techniques/T1078/002), compromise of federated cloud accounts may allow adversaries to more easily move laterally within an environment.</blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 10

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Account Locking](https://d3fend.mitre.org/techniques/d3f:AccountLocking)
* [Job Function Access Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:JobFunctionAccessPatternAnalysis)
* [Resource Access Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:ResourceAccessPatternAnalysis)
* [Session Duration Analysis](https://d3fend.mitre.org/techniques/d3f:SessionDurationAnalysis)
* [Authentication Event Thresholding](https://d3fend.mitre.org/techniques/d3f:AuthenticationEventThresholding)
* [Authorization Event Thresholding](https://d3fend.mitre.org/techniques/d3f:AuthorizationEventThresholding)
* [Multi-factor Authentication](https://d3fend.mitre.org/techniques/d3f:Multi-factorAuthentication)
* [One-time Password](https://d3fend.mitre.org/techniques/d3f:One-timePassword)
* [Strong Password Policy](https://d3fend.mitre.org/techniques/d3f:StrongPasswordPolicy)
* [User Account Permissions](https://d3fend.mitre.org/techniques/d3f:UserAccountPermissions)

## Technical Controls (Detection Rules)
### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:** 3

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/cloud/aws/aws_root_account_usage.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/aws_root_account_usage.yml)
* [sigma/rules/cloud/azure/azure_mfa_denies.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/azure/azure_mfa_denies.yml)
* [sigma/rules/cloud/azure/azure_mfa_interrupted.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/azure/azure_mfa_interrupted.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:** 17

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/cloud/abnormally_high_number_of_cloud_infrastructure_api_calls.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/abnormally_high_number_of_cloud_infrastructure_api_calls.yml)
* [security_content/detections/cloud/aws_setdefaultpolicyversion.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_setdefaultpolicyversion.yml)
* [security_content/detections/cloud/aws_create_policy_version_to_allow_all_resources.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_create_policy_version_to_allow_all_resources.yml)
* [security_content/detections/cloud/cloud_instance_modified_with_previously_unseen_user.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/cloud_instance_modified_with_previously_unseen_user.yml)
* [security_content/detections/cloud/abnormally_high_number_of_cloud_security_group_api_calls.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/abnormally_high_number_of_cloud_security_group_api_calls.yml)
* [security_content/detections/cloud/cloud_compute_instance_created_by_previously_unseen_user.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/cloud_compute_instance_created_by_previously_unseen_user.yml)
* [security_content/detections/deprecated/detect_aws_api_activities_from_unapproved_accounts.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/detect_aws_api_activities_from_unapproved_accounts.yml)
* [security_content/detections/deprecated/abnormally_high_aws_instances_launched_by_user.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/abnormally_high_aws_instances_launched_by_user.yml)
* [security_content/detections/deprecated/ec2_instance_started_with_previously_unseen_user.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ec2_instance_started_with_previously_unseen_user.yml)
* [security_content/detections/deprecated/ec2_instance_modified_with_previously_unseen_user.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ec2_instance_modified_with_previously_unseen_user.yml)
* [security_content/detections/deprecated/abnormally_high_aws_instances_terminated_by_user___mltk.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/abnormally_high_aws_instances_terminated_by_user___mltk.yml)
* [security_content/detections/deprecated/detect_new_api_calls_from_user_roles.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/detect_new_api_calls_from_user_roles.yml)
* [security_content/detections/deprecated/detect_new_user_aws_console_login.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/detect_new_user_aws_console_login.yml)
* [security_content/detections/deprecated/abnormally_high_aws_instances_launched_by_user___mltk.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/abnormally_high_aws_instances_launched_by_user___mltk.yml)
* [security_content/detections/deprecated/detect_spike_in_security_group_activity.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/detect_spike_in_security_group_activity.yml)
* [security_content/detections/deprecated/detect_spike_in_aws_api_activity.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/detect_spike_in_aws_api_activity.yml)
* [security_content/detections/deprecated/abnormally_high_aws_instances_terminated_by_user.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/abnormally_high_aws_instances_terminated_by_user.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:** 4

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1078.004/T1078.004.yaml):

* Creating GCP Service Account and Service Account Key
* Creating GCP Service Account and Service Account Key
* Creating GCP Service Account and Service Account Key
* Creating GCP Service Account and Service Account Key

