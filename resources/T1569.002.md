# T1569.002: Service Execution
**MITRE ATT&CK Tactic(s):** Execution

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1569/002)**
<blockquote>Adversaries may abuse the Windows service control manager to execute malicious commands or payloads. The Windows service control manager (<code>services.exe</code>) is an interface to manage and manipulate services.(Citation: Microsoft Service Control Manager) The service control manager is accessible to users via GUI components as well as system utilities such as <code>sc.exe</code> and [Net](https://attack.mitre.org/software/S0039).

[PsExec](https://attack.mitre.org/software/S0029) can also be used to execute commands or payloads via a temporary Windows service created through the service control manager API.(Citation: Russinovich Sysinternals) Tools such as [PsExec](https://attack.mitre.org/software/S0029) and <code>sc.exe</code> can accept remote servers as arguments and may be used to conduct remote execution.

Adversaries may leverage these mechanisms to execute malicious content. This can be done by either executing a new or modified service. This technique is the execution used in conjunction with [Windows Service](https://attack.mitre.org/techniques/T1543/003) during service persistence or privilege escalation.</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [no defensive relations yet](https://d3fend.mitre.org/techniques/d3f:nodefensiverelationsyet)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:**4

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-04-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-04-002.yaml)
* [car/analytics/CAR-2014-02-001.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2014-02-001.yaml)
* [car/analytics/CAR-2014-03-005.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2014-03-005.yaml)
* [car/analytics/CAR-2021-05-012.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-05-012.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**32

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/application/rpc_firewall/rpc_firewall_remote_service_lateral_movement.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/application/rpc_firewall/rpc_firewall_remote_service_lateral_movement.yml)
* [sigma/rules/network/zeek/zeek_dce_rpc_mitre_bzar_execution.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/network/zeek/zeek_dce_rpc_mitre_bzar_execution.yml)
* [sigma/rules/network/zeek/zeek_dns_mining_pools.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/network/zeek/zeek_dns_mining_pools.yml)
* [sigma/rules/windows/builtin/security/win_security_cobaltstrike_service_installs.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_cobaltstrike_service_installs.yml)
* [sigma/rules/windows/builtin/security/win_security_mal_creddumper.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_mal_creddumper.yml)
* [sigma/rules/windows/builtin/security/win_security_mal_service_installs.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_mal_service_installs.yml)
* [sigma/rules/windows/builtin/security/win_security_metasploit_or_impacket_smb_psexec_service_install.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_metasploit_or_impacket_smb_psexec_service_install.yml)
* [sigma/rules/windows/builtin/security/win_security_powershell_script_installed_as_service.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_security_powershell_script_installed_as_service.yml)
* [sigma/rules/windows/builtin/system/win_cobaltstrike_service_installs.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/win_cobaltstrike_service_installs.yml)
* [sigma/rules/windows/builtin/system/win_hack_smbexec.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/win_hack_smbexec.yml)
* [sigma/rules/windows/builtin/system/win_mal_creddumper.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/win_mal_creddumper.yml)
* [sigma/rules/windows/builtin/system/win_powershell_script_installed_as_service.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/win_powershell_script_installed_as_service.yml)
* [sigma/rules/windows/builtin/system/win_service_hacktools.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/win_service_hacktools.yml)
* [sigma/rules/windows/builtin/system/win_susp_proceshacker.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/win_susp_proceshacker.yml)
* [sigma/rules/windows/builtin/system/win_tool_psexec.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/win_tool_psexec.yml)
* [sigma/rules/windows/builtin/windefend/win_defender_psexec_wmi_asr.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/windefend/win_defender_psexec_wmi_asr.yml)
* [sigma/rules/windows/driver_load/driver_load_mal_creddumper.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_mal_creddumper.yml)
* [sigma/rules/windows/driver_load/driver_load_powershell_script_installed_as_service.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/driver_load/driver_load_powershell_script_installed_as_service.yml)
* [sigma/rules/windows/file_event/file_event_win_tool_psexec.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_tool_psexec.yml)
* [sigma/rules/windows/pipe_created/pipe_created_tool_psexec.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/pipe_created/pipe_created_tool_psexec.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_exploit_cve_2020_1350.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_exploit_cve_2020_1350.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_psexesvc_start.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_psexesvc_start.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_rpcss_anomalies.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rpcss_anomalies.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_rundll32_without_parameters.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_rundll32_without_parameters.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_service_execution.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_service_execution.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_tool_nircmd.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_tool_nircmd.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_tool_nircmd_as_system.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_tool_nircmd_as_system.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_tool_nsudo_as_system.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_tool_nsudo_as_system.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_tool_psexec.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_tool_psexec.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_tool_runx_as_system.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_tool_runx_as_system.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_cobaltstrike_service_installs.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_cobaltstrike_service_installs.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_powershell_as_service.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_powershell_as_service.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**4

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/malicious_powershell_executed_as_a_service.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/malicious_powershell_executed_as_a_service.yml)
* [security_content/detections/endpoint/detect_renamed_psexec.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_renamed_psexec.yml)
* [security_content/detections/endpoint/windows_service_created_with_suspicious_service_path.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_service_created_with_suspicious_service_path.yml)
* [security_content/detections/endpoint/excessive_usage_of_sc_service_utility.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/excessive_usage_of_sc_service_utility.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**3

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1569.002/T1569.002.yaml):

* Execute a Command as a Service
* Use PsExec to execute a command on a remote host
* psexec.py (Impacket)

### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 70

**ATT&CK-mapped resources for this (sub)technique:**2

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-04-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-04-002.yaml): 1 <code>unit_tests</code>
* [car/analytics/CAR-2021-05-012.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-05-012.yaml): 2 <code>unit_tests</code>

