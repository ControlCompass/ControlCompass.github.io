# T1548.002: Bypass User Account Control
**MITRE ATT&CK Tactic(s):** Privilege Escalation, Defense Evasion

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1548/002)**
<blockquote>Adversaries may bypass UAC mechanisms to elevate process privileges on system. Windows User Account Control (UAC) allows a program to elevate its privileges (tracked as integrity levels ranging from low to high) to perform a task under administrator-level permissions, possibly by prompting the user for confirmation. The impact to the user ranges from denying the operation under high enforcement to allowing the user to perform the action if they are in the local administrators group and click through the prompt or allowing them to enter an administrator password to complete the action. (Citation: TechNet How UAC Works)

If the UAC protection level of a computer is set to anything but the highest level, certain Windows programs can elevate privileges or execute some elevated [Component Object Model](https://attack.mitre.org/techniques/T1559/001) objects without prompting the user through the UAC notification box. (Citation: TechNet Inside UAC) (Citation: MSDN COM Elevation) An example of this is use of [Rundll32](https://attack.mitre.org/techniques/T1218/011) to load a specifically crafted DLL which loads an auto-elevated [Component Object Model](https://attack.mitre.org/techniques/T1559/001) object and performs a file operation in a protected directory which would typically require elevated access. Malicious software may also be injected into a trusted process to gain elevated privileges without prompting a user.(Citation: Davidson Windows)

Many methods have been discovered to bypass UAC. The Github readme page for UACME contains an extensive list of methods(Citation: Github UACMe) that have been discovered and implemented, but may not be a comprehensive list of bypasses. Additional bypass methods are regularly discovered and some used in the wild, such as:

* <code>eventvwr.exe</code> can auto-elevate and execute a specified binary or script.(Citation: enigma0x3 Fileless UAC Bypass)(Citation: Fortinet Fareit)

Another bypass is possible through some lateral movement techniques if credentials for an account with administrator privileges are known, since UAC is a single system security mechanism, and the privilege or integrity of a process running on one system will be unknown on remote systems and default to high integrity.(Citation: SANS UAC Bypass)</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**10

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)
* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)
* [Dynamic Analysis](https://d3fend.mitre.org/techniques/d3f:DynamicAnalysis)
* [Executable Allowlisting](https://d3fend.mitre.org/techniques/d3f:ExecutableAllowlisting)
* [Executable Denylisting](https://d3fend.mitre.org/techniques/d3f:ExecutableDenylisting)
* [Emulated File Analysis](https://d3fend.mitre.org/techniques/d3f:EmulatedFileAnalysis)
* [Process Spawn Analysis](https://d3fend.mitre.org/techniques/d3f:ProcessSpawnAnalysis)
* [System Call Analysis](https://d3fend.mitre.org/techniques/d3f:SystemCallAnalysis)
* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)
* [System Call Filtering](https://d3fend.mitre.org/techniques/d3f:SystemCallFiltering)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:**3

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-10-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-10-002.yaml)
* [car/analytics/CAR-2019-04-001.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2019-04-001.yaml)
* [car/analytics/CAR-2021-01-008.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-01-008.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**45

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/windows/file_event/file_event_win_uac_bypass_consent_comctl32.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_uac_bypass_consent_comctl32.yml)
* [sigma/rules/windows/file_event/file_event_win_uac_bypass_dotnet_profiler.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_uac_bypass_dotnet_profiler.yml)
* [sigma/rules/windows/file_event/file_event_win_uac_bypass_ieinstal.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_uac_bypass_ieinstal.yml)
* [sigma/rules/windows/file_event/file_event_win_uac_bypass_msconfig_gui.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_uac_bypass_msconfig_gui.yml)
* [sigma/rules/windows/file_event/file_event_win_uac_bypass_ntfs_reparse_point.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_uac_bypass_ntfs_reparse_point.yml)
* [sigma/rules/windows/file_event/file_event_win_uac_bypass_winsat.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_uac_bypass_winsat.yml)
* [sigma/rules/windows/file_event/file_event_win_uac_bypass_wmp.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_uac_bypass_wmp.yml)
* [sigma/rules/windows/image_load/image_load_uac_bypass_via_dism.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_uac_bypass_via_dism.yml)
* [sigma/rules/windows/process_access/proc_access_win_load_undocumented_autoelevated_com_interface.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_load_undocumented_autoelevated_com_interface.yml)
* [sigma/rules/windows/process_access/proc_access_win_uac_bypass_wow64_logger.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_uac_bypass_wow64_logger.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_always_install_elevated_msi_spawned_cmd_powershell.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_always_install_elevated_msi_spawned_cmd_powershell.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_always_install_elevated_windows_installer.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_always_install_elevated_windows_installer.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_cmstp_com_object_access.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmstp_com_object_access.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_high_integrity_sdclt.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_high_integrity_sdclt.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_hktl_uacme_uac_bypass.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hktl_uacme_uac_bypass.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_sdclt_child_process.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sdclt_child_process.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_explorer_nouaccheck.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_explorer_nouaccheck.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_powershell_empire_uac_bypass.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_powershell_empire_uac_bypass.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_uac_bypass_trustedpath.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_uac_bypass_trustedpath.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_sysmon_uac_bypass_eventvwr.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysmon_uac_bypass_eventvwr.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_changepk_slui.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_changepk_slui.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_cleanmgr.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_cleanmgr.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_computerdefaults.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_computerdefaults.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_consent_comctl32.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_consent_comctl32.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_dismhost.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_dismhost.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_ieinstal.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_ieinstal.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_msconfig_gui.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_msconfig_gui.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_ntfs_reparse_point.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_ntfs_reparse_point.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_pkgmgr_dism.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_pkgmgr_dism.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_winsat.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_winsat.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_wmp.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_wmp.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_bypass_wsreset.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_bypass_wsreset.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_cmstp.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_cmstp.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_fodhelper.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_fodhelper.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uac_wsreset.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uac_wsreset.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_wsreset_uac_bypass.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_wsreset_uac_bypass.yml)
* [sigma/rules/windows/registry/registry_event/registry_event_bypass_via_wsreset.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_bypass_via_wsreset.yml)
* [sigma/rules/windows/registry/registry_event/registry_event_shell_open_keys_manipulation.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_shell_open_keys_manipulation.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_bypass_uac_using_delegateexecute.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_bypass_uac_using_delegateexecute.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_bypass_uac_using_silentcleanup_task.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_bypass_uac_using_silentcleanup_task.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_disable_uac_registry.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_disable_uac_registry.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_uac_bypass_eventvwr.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_uac_bypass_eventvwr.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_uac_bypass_sdclt.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_uac_bypass_sdclt.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_uac_bypass_winsat.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_uac_bypass_winsat.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_uac_bypass_wmp.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_uac_bypass_wmp.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**12

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/sdclt_uac_bypass.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/sdclt_uac_bypass.yml)
* [security_content/detections/endpoint/net_profiler_uac_bypass.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/net_profiler_uac_bypass.yml)
* [security_content/detections/endpoint/fodhelper_uac_bypass.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/fodhelper_uac_bypass.yml)
* [security_content/detections/endpoint/disable_uac_remote_restriction.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_uac_remote_restriction.yml)
* [security_content/detections/endpoint/wsreset_uac_bypass.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/wsreset_uac_bypass.yml)
* [security_content/detections/endpoint/disabling_remote_user_account_control.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_remote_user_account_control.yml)
* [security_content/detections/endpoint/eventvwr_uac_bypass.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/eventvwr_uac_bypass.yml)
* [security_content/detections/endpoint/ssa___windows_eventvwr_uac_bypass.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ssa___windows_eventvwr_uac_bypass.yml)
* [security_content/detections/endpoint/slui_runas_elevated.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/slui_runas_elevated.yml)
* [security_content/detections/endpoint/slui_spawning_a_process.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/slui_spawning_a_process.yml)
* [security_content/detections/endpoint/silentcleanup_uac_bypass.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/silentcleanup_uac_bypass.yml)
* [security_content/detections/endpoint/uac_bypass_mmc_load_unsigned_dll.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/uac_bypass_mmc_load_unsigned_dll.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**34

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1548.002/T1548.002.yaml):

* Bypass UAC using Event Viewer (cmd)
* Bypass UAC using Event Viewer (PowerShell)
* Bypass UAC using Fodhelper
* Bypass UAC using Fodhelper - PowerShell
* Bypass UAC using ComputerDefaults (PowerShell)
* Bypass UAC by Mocking Trusted Directories
* Bypass UAC using sdclt DelegateExecute
* Disable UAC using reg.exe
* Bypass UAC using SilentCleanup task
* UACME Bypass Method 23
* UACME Bypass Method 31
* UACME Bypass Method 33
* UACME Bypass Method 34
* UACME Bypass Method 39
* UACME Bypass Method 56
* UACME Bypass Method 59
* UACME Bypass Method 61
* Bypass UAC using Event Viewer (cmd)
* Bypass UAC using Event Viewer (PowerShell)
* Bypass UAC using Fodhelper
* Bypass UAC using Fodhelper - PowerShell
* Bypass UAC using ComputerDefaults (PowerShell)
* Bypass UAC by Mocking Trusted Directories
* Bypass UAC using sdclt DelegateExecute
* Disable UAC using reg.exe
* Bypass UAC using SilentCleanup task
* UACME Bypass Method 23
* UACME Bypass Method 31
* UACME Bypass Method 33
* UACME Bypass Method 34
* UACME Bypass Method 39
* UACME Bypass Method 56
* UACME Bypass Method 59
* UACME Bypass Method 61

