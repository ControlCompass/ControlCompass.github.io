# T1546: Event Triggered Execution
**MITRE ATT&CK Tactic(s):** Privilege Escalation, Persistence

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1546)**
<blockquote>Adversaries may establish persistence and/or elevate privileges using system mechanisms that trigger execution based on specific events. Various operating systems have means to monitor and subscribe to events such as logons or other user activity such as running specific applications/binaries. 

Adversaries may abuse these mechanisms as a means of maintaining persistent access to a victim via repeatedly executing malicious code. After gaining access to a victim system, adversaries may create/modify event triggers to point to malicious content that will be executed whenever the event trigger is invoked.(Citation: FireEye WMI 2015)(Citation: Malware Persistence on OS X)(Citation: amnesia malware)

Since the execution can be proxied by an account with higher permissions, such as SYSTEM or service accounts, an adversary may be able to abuse these triggered execution mechanisms to escalate their privileges. </blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**27

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)
* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)
* [Emulated File Analysis](https://d3fend.mitre.org/techniques/d3f:EmulatedFileAnalysis)
* [Dynamic Analysis](https://d3fend.mitre.org/techniques/d3f:DynamicAnalysis)
* [Administrative Network Activity Analysis](https://d3fend.mitre.org/techniques/d3f:AdministrativeNetworkActivityAnalysis)
* [Protocol Metadata Anomaly Detection](https://d3fend.mitre.org/techniques/d3f:ProtocolMetadataAnomalyDetection)
* [Connection Attempt Analysis](https://d3fend.mitre.org/techniques/d3f:ConnectionAttemptAnalysis)
* [Client-server Payload Profiling](https://d3fend.mitre.org/techniques/d3f:Client-serverPayloadProfiling)
* [Network Traffic Community Deviation](https://d3fend.mitre.org/techniques/d3f:NetworkTrafficCommunityDeviation)
* [Remote Terminal Session Detection](https://d3fend.mitre.org/techniques/d3f:RemoteTerminalSessionDetection)
* [Per Host Download-Upload Ratio Analysis](https://d3fend.mitre.org/techniques/d3f:PerHostDownload-UploadRatioAnalysis)
* [System Call Analysis](https://d3fend.mitre.org/techniques/d3f:SystemCallAnalysis)
* [Process Self-Modification Detection](https://d3fend.mitre.org/techniques/d3f:ProcessSelf-ModificationDetection)
* [Process Spawn Analysis](https://d3fend.mitre.org/techniques/d3f:ProcessSpawnAnalysis)
* [User Geolocation Logon Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:UserGeolocationLogonPatternAnalysis)
* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)
* [Software Update](https://d3fend.mitre.org/techniques/d3f:SoftwareUpdate)
* [Executable Allowlisting](https://d3fend.mitre.org/techniques/d3f:ExecutableAllowlisting)
* [Executable Denylisting](https://d3fend.mitre.org/techniques/d3f:ExecutableDenylisting)
* [Hardware-based Process Isolation](https://d3fend.mitre.org/techniques/d3f:Hardware-basedProcessIsolation)
* [Process Termination](https://d3fend.mitre.org/techniques/d3f:ProcessTermination)
* [Outbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:OutboundTrafficFiltering)
* [Inbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:InboundTrafficFiltering)
* [Process Lineage Analysis](https://d3fend.mitre.org/techniques/d3f:ProcessLineageAnalysis)
* [User Session Init Config Analysis](https://d3fend.mitre.org/techniques/d3f:UserSessionInitConfigAnalysis)
* [System Call Filtering](https://d3fend.mitre.org/techniques/d3f:SystemCallFiltering)
* [Mandatory Access Control](https://d3fend.mitre.org/techniques/d3f:MandatoryAccessControl)

## Technical Controls (Detection Rules)
### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**7

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/windows/file_event/file_event_win_outlook_c2_macro_creation.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_outlook_c2_macro_creation.yml)
* [sigma/rules/windows/powershell/powershell_script/posh_ps_suspicious_gwmi.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_suspicious_gwmi.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_hafnium.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_hafnium.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_sourgrum.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_sourgrum.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_control_panel_item.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_control_panel_item.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_comhijack_sdclt.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_comhijack_sdclt.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_outlook_c2_registry_key.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_outlook_c2_registry_key.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**12

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/powershell_execute_com_object.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/powershell_execute_com_object.yml)
* [security_content/detections/endpoint/registry_keys_for_creating_shim_databases.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/registry_keys_for_creating_shim_databases.yml)
* [security_content/detections/endpoint/shim_database_file_creation.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/shim_database_file_creation.yml)
* [security_content/detections/endpoint/detect_wmi_event_subscription_persistence.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_wmi_event_subscription_persistence.yml)
* [security_content/detections/endpoint/overwriting_accessibility_binaries.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/overwriting_accessibility_binaries.yml)
* [security_content/detections/endpoint/shim_database_installation_with_suspicious_parameters.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/shim_database_installation_with_suspicious_parameters.yml)
* [security_content/detections/endpoint/registry_keys_used_for_privilege_escalation.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/registry_keys_used_for_privilege_escalation.yml)
* [security_content/detections/endpoint/screensaver_event_trigger_execution.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/screensaver_event_trigger_execution.yml)
* [security_content/detections/endpoint/linux_file_creation_in_profile_directory.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/linux_file_creation_in_profile_directory.yml)
* [security_content/detections/endpoint/wmi_permanent_event_subscription___sysmon.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/wmi_permanent_event_subscription___sysmon.yml)
* [security_content/detections/endpoint/change_default_file_association.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/change_default_file_association.yml)
* [security_content/detections/endpoint/linux_possible_append_command_to_profile_config_file.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/linux_possible_append_command_to_profile_config_file.yml)


## Offensive Security Tests
