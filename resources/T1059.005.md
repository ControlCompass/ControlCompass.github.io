# T1059.005: Visual Basic
**MITRE ATT&CK Tactic(s):** Execution

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1059/005)**
<blockquote>Adversaries may abuse Visual Basic (VB) for execution. VB is a programming language created by Microsoft with interoperability with many Windows technologies such as [Component Object Model](https://attack.mitre.org/techniques/T1559/001) and the [Native API](https://attack.mitre.org/techniques/T1106) through the Windows API. Although tagged as legacy with no planned future evolutions, VB is integrated and supported in the .NET Framework and cross-platform .NET Core.(Citation: VB .NET Mar 2020)(Citation: VB Microsoft)

Derivative languages based on VB have also been created, such as Visual Basic for Applications (VBA) and VBScript. VBA is an event-driven programming language built into Microsoft Office, as well as several third-party applications.(Citation: Microsoft VBA)(Citation: Wikipedia VBA) VBA enables documents to contain macros used to automate the execution of tasks and other functionality on the host. VBScript is a default scripting language on Windows hosts and can also be used in place of [JavaScript](https://attack.mitre.org/techniques/T1059/007) on HTML Application (HTA) webpages served to Internet Explorer (though most modern browsers do not come with VBScript support).(Citation: Microsoft VBScript)

Adversaries may use VB payloads to execute malicious commands. Common malicious usage includes automating execution of behaviors with VBScript or embedding VBA content into [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001) payloads.</blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 7

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)
* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)
* [Dynamic Analysis](https://d3fend.mitre.org/techniques/d3f:DynamicAnalysis)
* [Emulated File Analysis](https://d3fend.mitre.org/techniques/d3f:EmulatedFileAnalysis)
* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)
* [Executable Allowlisting](https://d3fend.mitre.org/techniques/d3f:ExecutableAllowlisting)
* [Executable Denylisting](https://d3fend.mitre.org/techniques/d3f:ExecutableDenylisting)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-04-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-04-002.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:** 19

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/windows/builtin/applocker/win_applocker_file_was_not_allowed_to_run.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/applocker/win_applocker_file_was_not_allowed_to_run.yml)
* [sigma/rules/windows/create_remote_thread/sysmon_cactustorch.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/create_remote_thread/sysmon_cactustorch.yml)
* [sigma/rules/windows/file_event/file_event_win_mal_adwind.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_mal_adwind.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_cloudhopper.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_cloudhopper.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_bypass_squiblytwo.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_bypass_squiblytwo.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_hack_koadic.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hack_koadic.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_html_help_spawn.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_html_help_spawn.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_lolbin_cscript_gathernetworkinfo.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_cscript_gathernetworkinfo.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_malware_qbot.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_malware_qbot.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_malware_script_dropper.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_malware_script_dropper.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_mal_adwind.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mal_adwind.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_shell_spawn_mshta.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_shell_spawn_mshta.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_shell_spawn_susp_program.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_shell_spawn_susp_program.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_bginfo.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_bginfo.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_csc.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_csc.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_cscript_vbs.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_cscript_vbs.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_script_execution.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_script_execution.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_mal_adwind.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_mal_adwind.yml)
* [sigma/rules/windows/wmi_event/sysmon_wmi_susp_scripting.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/wmi_event/sysmon_wmi_susp_scripting.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:** 4

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/execute_javascript_with_jscript_com_clsid.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/execute_javascript_with_jscript_com_clsid.yml)
* [security_content/detections/endpoint/suspicious_process_dns_query_known_abuse_web_services.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_process_dns_query_known_abuse_web_services.yml)
* [security_content/detections/endpoint/vbscript_execution_using_wscript_app.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/vbscript_execution_using_wscript_app.yml)
* [security_content/detections/endpoint/suspicious_process_with_discord_dns_query.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_process_with_discord_dns_query.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:** 3

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1059.005/T1059.005.yaml):

* Visual Basic script execution to gather local computer information
* Encoded VBS code execution
* Extract Memory via VBA

### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 28, 2022

**Total ATT&CK-mapped tests:** 70

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-04-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-04-002.yaml): 1 <code>unit_tests</code>

