# T1562.002: Disable Windows Event Logging
**MITRE ATT&CK Tactic(s):** Defense Evasion

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1562/002)**
<blockquote>Adversaries may disable Windows event logging to limit data that can be leveraged for detections and audits. Windows event logs record user and system activity such as login attempts, process creation, and much more.(Citation: Windows Log Events) This data is used by security tools and analysts to generate detections.

The EventLog service maintains event logs from various system components and applications.(Citation: EventLog_Core_Technologies) By default, the service automatically starts when a system powers on. An audit policy, maintained by the Local Security Policy (secpol.msc), defines which system events the EventLog service logs. Security audit policy settings can be changed by running secpol.msc, then navigating to <code>Security Settings\Local Policies\Audit Policy</code> for basic audit policy settings or <code>Security Settings\Advanced Audit Policy Configuration</code> for advanced audit policy settings.(Citation: Audit_Policy_Microsoft)(Citation: Advanced_sec_audit_policy_settings) <code>auditpol.exe</code> may also be used to set audit policies.(Citation: auditpol)

Adversaries may target system-wide logging or just that of a particular application. For example, the EventLog service may be disabled using the following PowerShell line: <code>Stop-Service -Name EventLog</code>.(Citation: Disable_Win_Event_Logging) Additionally, adversaries may use <code>auditpol</code> and its sub-commands in a command prompt to disable auditing or clear the audit policy. To enable or disable a specified setting or audit category, adversaries may use the <code>/success</code> or <code>/failure</code> parameters. For example, <code>auditpol /set /category:â€Account Logonâ€ /success:disable /failure:disable</code> turns off auditing for the Account Logon category.(Citation: auditpol.exe_STRONTIC)(Citation: T1562.002_redcanaryco) To clear the audit policy, adversaries may run the following lines: <code>auditpol /clear /y</code> or <code>auditpol /remove /allusers</code>.(Citation: T1562.002_redcanaryco)

By disabling Windows event logging, adversaries can operate while leaving less evidence of a compromise behind.</blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** May 23, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Application Configuration Hardening](https://d3fend.mitre.org/technique/d3f:ApplicationConfigurationHardening)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** August 09, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[analytics](https://github.com/mitre-attack/car/blob/master/analytics)</code> folder:

* [Disable Windows Event Logging](https://github.com/mitre-attack/car/tree/master/analytics/CAR-2022-03-001.yaml)

### [Elastic Detection Rules](https://github.com/elastic/detection-rules)
**Last accessed:** August 09, 2022

**Total ATT&CK-mapped rules:** 641

**ATT&CK-mapped resources for this (sub)technique:** 2

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[rules](https://github.com/elastic/detection-rules/tree/main/rules)</code> folder:

* [windows](https://github.com/elastic/detection-rules/tree/main/rules/windows/) / **[PowerShell Script Block Logging Disabled](https://github.com/elastic/detection-rules/blob/main/rules/windows/defense_evasion_disable_posh_scriptblocklogging.toml)**
* [windows](https://github.com/elastic/detection-rules/tree/main/rules/windows/) / **[IIS HTTP Logging Disabled](https://github.com/elastic/detection-rules/blob/main/rules/windows/defense_evasion_iis_httplogging_disabled.toml)**

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** August 09, 2022

**Total ATT&CK-mapped rules:** 2578

**ATT&CK-mapped resources for this (sub)technique:** 7

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[rules](https://github.com/SigmaHQ/sigma/tree/master/rules)</code> folder:

* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [builtin](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/) / [security](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/builtin/security/) / **[Disabling Windows Event Auditing](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_disable_event_logging.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [process_access](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_access/) / **[Suspect Svchost Memory Asccess](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_invoke_phantom.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [process_creation](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/) / **[Disable Windows IIS HTTP Logging](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_iis_http_logging.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [process_creation](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/) / **[Suspicious NT Resource Kit Auditpol Usage](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_nt_resource_kit_auditpol_usage.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [process_creation](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/) / **[Suspicious Auditpol Usage](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sus_auditpol_usage.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [process_creation](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/) / **[Sysmon Driver Unload](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sysmon_driver_unload.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [registry](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/) / [registry_set](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_set/) / **[Disable Winevt Event Logging Via Registry](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_disable_winevt_logging.yml)**


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** August 10, 2022

**Total ATT&CK-mapped tests:** 1341

**ATT&CK-mapped resources for this (sub)technique:** 6

The following unit tests mapped to this (sub)technique can be located in [the file here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1562.002/T1562.002.yaml):

* Disable Windows IIS HTTP Logging
* Kill Event Log Service Threads
* Impair Windows Audit Log Policy
* Clear Windows Audit Policy Config
* Disable Event Logging with wevtutil
* Makes Eventlog blind with Phant0m

### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** August 10, 2022

**Total ATT&CK-mapped tests:** 70

**ATT&CK-mapped resources for this (sub)technique:** 7

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [Disable Windows Event Logging](https://github.com/mitre-attack/car/tree/master/analytics/CAR-2022-03-001.yaml): 7 unit tests

