# T1135: Network Share Discovery
**MITRE ATT&CK Tactic(s):** Discovery

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1135)**
<blockquote>Adversaries may look for folders and drives shared on remote systems as a means of identifying sources of information to gather as a precursor for Collection and to identify potential systems of interest for Lateral Movement. Networks often contain shared network drives and folders that enable users to access file directories on various systems across a network. 

File sharing over a Windows network occurs over the SMB protocol. (Citation: Wikipedia Shared Resource) (Citation: TechNet Shared Folder) [Net](https://attack.mitre.org/software/S0039) can be used to query a remote system for available shared drives using the <code>net view \\\\remotesystem</code> command. It can also be used to query shared drives on the local system using <code>net share</code>. For macOS, the <code>sharing -l</code> command lists all shared points used for smb services.</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [no defensive relations yet](https://d3fend.mitre.org/techniques/d3f:nodefensiverelationsyet)

## Technical Controls (Detection Rules)
### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**7

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/windows/process_creation/proc_creation_win_advanced_ip_scanner.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_advanced_ip_scanner.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_advanced_port_scanner.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_advanced_port_scanner.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_turla_commands_critical.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_turla_commands_critical.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_turla_commands_medium.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_turla_commands_medium.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_malware_dridex.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_malware_dridex.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_net_execution.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_net_execution.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_sharpview.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_sharpview.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**3

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/deprecated/ssa___recon_and_use_shares_via_mimikatz_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___recon_and_use_shares_via_mimikatz_modules.yml)
* [security_content/detections/deprecated/ssa___recon_and_use_shares_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___recon_and_use_shares_via_powersploit_modules.yml)
* [security_content/detections/deprecated/ssa___recon_connectivity_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___recon_connectivity_via_powersploit_modules.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**7

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1135/T1135.yaml):

* Network Share Discovery
* Network Share Discovery - linux
* Network Share Discovery command prompt
* Network Share Discovery PowerShell
* View available share drives
* Share Discovery with PowerView
* PowerView ShareFinder

