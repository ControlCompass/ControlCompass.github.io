# T1539: Steal Web Session Cookie
**MITRE ATT&CK Tactic(s):** Credential Access

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1539)**
<blockquote>An adversary may steal web application or service session cookies and use them to gain access to web applications or Internet services as an authenticated user without needing credentials. Web applications and services often use session cookies as an authentication token after a user has authenticated to a website.

Cookies are often valid for an extended period of time, even if the web application is not actively used. Cookies can be found on disk, in the process memory of the browser, and in network traffic to remote systems. Additionally, other applications on the targets machine might store sensitive authentication cookies in memory (e.g. apps which authenticate to cloud services). Session cookies can be used to bypasses some multi-factor authentication protocols.(Citation: Pass The Cookie)

There are several examples of malware targeting cookies from web browsers on the local system.(Citation: Kaspersky TajMahal April 2019)(Citation: Unit 42 Mac Crypto Cookies January 2019) There are also open source frameworks such as Evilginx 2 and Muraena that can gather session cookies through a malicious proxy (ex: [Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1557)) that can be set up by an adversary and used in phishing campaigns.(Citation: Github evilginx2)(Citation: GitHub Mauraena)

After an adversary acquires a valid cookie, they can then perform a [Web Session Cookie](https://attack.mitre.org/techniques/T1550/004) technique to login to the corresponding web application.</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**4

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Decoy User Credential](https://d3fend.mitre.org/techniques/d3f:DecoyUserCredential)
* [Credential Compromise Scope Analysis](https://d3fend.mitre.org/techniques/d3f:CredentialCompromiseScopeAnalysis)
* [Authentication Cache Invalidation](https://d3fend.mitre.org/techniques/d3f:AuthenticationCacheInvalidation)
* [Credential Transmission Scoping](https://d3fend.mitre.org/techniques/d3f:CredentialTransmissionScoping)

## Technical Controls (Detection Rules)
### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/windows/process_creation/proc_creation_win_sqlite_firefox_cookies.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_sqlite_firefox_cookies.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**1

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1539/T1539.yaml):

* Steal Firefox Cookies (Windows)

