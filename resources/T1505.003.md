# T1505.003: Web Shell
**MITRE ATT&CK Tactic(s):** Persistence

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1505/003)**
<blockquote>Adversaries may backdoor web servers with web shells to establish persistent access to systems. A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to use the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server.

In addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (ex: [China Chopper](https://attack.mitre.org/software/S0020) Web shell client).(Citation: Lee 2013) </blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 14

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)
* [Dynamic Analysis](https://d3fend.mitre.org/techniques/d3f:DynamicAnalysis)
* [Emulated File Analysis](https://d3fend.mitre.org/techniques/d3f:EmulatedFileAnalysis)
* [Process Spawn Analysis](https://d3fend.mitre.org/techniques/d3f:ProcessSpawnAnalysis)
* [Process Termination](https://d3fend.mitre.org/techniques/d3f:ProcessTermination)
* [Process Self-Modification Detection](https://d3fend.mitre.org/techniques/d3f:ProcessSelf-ModificationDetection)
* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)
* [Decoy Network Resource](https://d3fend.mitre.org/techniques/d3f:DecoyNetworkResource)
* [Hardware-based Process Isolation](https://d3fend.mitre.org/techniques/d3f:Hardware-basedProcessIsolation)
* [Executable Allowlisting](https://d3fend.mitre.org/techniques/d3f:ExecutableAllowlisting)
* [Executable Denylisting](https://d3fend.mitre.org/techniques/d3f:ExecutableDenylisting)
* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)
* [Mandatory Access Control](https://d3fend.mitre.org/techniques/d3f:MandatoryAccessControl)
* [Process Lineage Analysis](https://d3fend.mitre.org/techniques/d3f:ProcessLineageAnalysis)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2021-02-001.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-02-001.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:** 23

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/application/antivirus/av_webshell.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/application/antivirus/av_webshell.yml)
* [sigma/rules/linux/auditd/lnx_auditd_web_rce.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_web_rce.yml)
* [sigma/rules/linux/builtin/lnx_shellshock.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/builtin/lnx_shellshock.yml)
* [sigma/rules/linux/process_creation/proc_creation_lnx_webshell_detection.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_webshell_detection.yml)
* [sigma/rules/web/web_cve_2018_2894_weblogic_exploit.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/web/web_cve_2018_2894_weblogic_exploit.yml)
* [sigma/rules/web/web_cve_2021_40539_manageengine_adselfservice_exploit.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/web/web_cve_2021_40539_manageengine_adselfservice_exploit.yml)
* [sigma/rules/web/web_solarwinds_supernova_webshell.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/web/web_solarwinds_supernova_webshell.yml)
* [sigma/rules/web/web_unc2546_dewmode_php_webshell.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/web/web_unc2546_dewmode_php_webshell.yml)
* [sigma/rules/web/web_webshell_keyword.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/web/web_webshell_keyword.yml)
* [sigma/rules/web/win_webshell_regeorg.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/web/win_webshell_regeorg.yml)
* [sigma/rules/windows/builtin/msexchange/win_exchange_proxyshell_certificate_generation.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/msexchange/win_exchange_proxyshell_certificate_generation.yml)
* [sigma/rules/windows/builtin/msexchange/win_exchange_proxyshell_mailbox_export.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/msexchange/win_exchange_proxyshell_mailbox_export.yml)
* [sigma/rules/windows/builtin/msexchange/win_set_oabvirtualdirectory_externalurl.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/msexchange/win_set_oabvirtualdirectory_externalurl.yml)
* [sigma/rules/windows/file_event/file_event_win_susp_exchange_aspx_write.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_susp_exchange_aspx_write.yml)
* [sigma/rules/windows/file_event/file_event_win_webshell_creation_detect.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_webshell_creation_detect.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_mailboxexport_share.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mailboxexport_share.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_execution_path_webserver.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_execution_path_webserver.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_iss_module_install.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_iss_module_install.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_shell_spawn_from_mssql.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_shell_spawn_from_mssql.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_webshell_detection.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_detection.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_webshell_hacking.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_hacking.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_webshell_recon_detection.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_recon_detection.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_webshell_spawn.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_webshell_spawn.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:** 2

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/w3wp_spawning_shell.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/w3wp_spawning_shell.yml)
* [security_content/detections/endpoint/detect_exchange_web_shell.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_exchange_web_shell.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:** 1

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1505.003/T1505.003.yaml):

* Web Shell Written to Disk

