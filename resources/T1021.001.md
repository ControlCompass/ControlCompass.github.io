# T1021.001: Remote Desktop Protocol
**MITRE ATT&CK Tactic(s):** Lateral Movement

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1021/001)**
<blockquote>Adversaries may use [Valid Accounts](https://attack.mitre.org/techniques/T1078) to log into a computer using the Remote Desktop Protocol (RDP). The adversary may then perform actions as the logged-on user.

Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS).(Citation: TechNet Remote Desktop Services) 

Adversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the [Accessibility Features](https://attack.mitre.org/techniques/T1546/008) technique for Persistence.(Citation: Alperovitch Malware)</blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 9

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Outbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:OutboundTrafficFiltering)
* [Inbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:InboundTrafficFiltering)
* [Remote Terminal Session Detection](https://d3fend.mitre.org/techniques/d3f:RemoteTerminalSessionDetection)
* [Client-server Payload Profiling](https://d3fend.mitre.org/techniques/d3f:Client-serverPayloadProfiling)
* [Network Traffic Community Deviation](https://d3fend.mitre.org/techniques/d3f:NetworkTrafficCommunityDeviation)
* [Per Host Download-Upload Ratio Analysis](https://d3fend.mitre.org/techniques/d3f:PerHostDownload-UploadRatioAnalysis)
* [Protocol Metadata Anomaly Detection](https://d3fend.mitre.org/techniques/d3f:ProtocolMetadataAnomalyDetection)
* [Connection Attempt Analysis](https://d3fend.mitre.org/techniques/d3f:ConnectionAttemptAnalysis)
* [User Geolocation Logon Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:UserGeolocationLogonPatternAnalysis)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:** 3

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-07-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-07-002.yaml)
* [car/analytics/CAR-2013-10-001.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-10-001.yaml)
* [car/analytics/CAR-2016-04-005.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2016-04-005.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:** 11

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/network/zeek/zeek_rdp_public_listener.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/network/zeek/zeek_rdp_public_listener.yml)
* [sigma/rules/windows/builtin/security/win_not_allowed_rdp_access.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_not_allowed_rdp_access.yml)
* [sigma/rules/windows/builtin/security/win_rdp_localhost_login.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_rdp_localhost_login.yml)
* [sigma/rules/windows/builtin/security/win_rdp_reverse_tunnel.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_rdp_reverse_tunnel.yml)
* [sigma/rules/windows/network_connection/net_connection_win_rdp_reverse_tunnel.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_rdp_reverse_tunnel.yml)
* [sigma/rules/windows/network_connection/net_connection_win_susp_rdp.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/network_connection/net_connection_win_susp_rdp.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_mstsc.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mstsc.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_reg_enable_rdp.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_enable_rdp.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_add_user_remote_desktop.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_add_user_remote_desktop.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_plink_remote_forward.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_plink_remote_forward.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_tscon_rdp_redirect.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_tscon_rdp_redirect.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:** 2

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/allow_inbound_traffic_in_firewall_rule.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/allow_inbound_traffic_in_firewall_rule.yml)
* [security_content/detections/endpoint/allow_inbound_traffic_by_firewall_rule_registry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/allow_inbound_traffic_by_firewall_rule_registry.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:** 4

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1021.001/T1021.001.yaml):

* RDP to DomainController
* RDP to Server
* Changing RDP Port to Non Standard Port via Powershell
* Changing RDP Port to Non Standard Port via Command_Prompt

