# T1098: Account Manipulation
**MITRE ATT&CK Tactic(s):** Persistence

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1098)**
<blockquote>Adversaries may manipulate accounts to maintain access to victim systems. Account manipulation may consist of any action that preserves adversary access to a compromised account, such as modifying credentials or permission groups. These actions could also include account activity designed to subvert security policies, such as performing iterative password updates to bypass password duration policies and preserve the life of compromised credentials. In order to create or manipulate accounts, the adversary must already have sufficient permissions on systems or the domain.</blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 20

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Remote Terminal Session Detection](https://d3fend.mitre.org/techniques/d3f:RemoteTerminalSessionDetection)
* [Per Host Download-Upload Ratio Analysis](https://d3fend.mitre.org/techniques/d3f:PerHostDownload-UploadRatioAnalysis)
* [Protocol Metadata Anomaly Detection](https://d3fend.mitre.org/techniques/d3f:ProtocolMetadataAnomalyDetection)
* [Administrative Network Activity Analysis](https://d3fend.mitre.org/techniques/d3f:AdministrativeNetworkActivityAnalysis)
* [User Geolocation Logon Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:UserGeolocationLogonPatternAnalysis)
* [Credential Compromise Scope Analysis](https://d3fend.mitre.org/techniques/d3f:CredentialCompromiseScopeAnalysis)
* [Connection Attempt Analysis](https://d3fend.mitre.org/techniques/d3f:ConnectionAttemptAnalysis)
* [Network Traffic Community Deviation](https://d3fend.mitre.org/techniques/d3f:NetworkTrafficCommunityDeviation)
* [Client-server Payload Profiling](https://d3fend.mitre.org/techniques/d3f:Client-serverPayloadProfiling)
* [Strong Password Policy](https://d3fend.mitre.org/techniques/d3f:StrongPasswordPolicy)
* [One-time Password](https://d3fend.mitre.org/techniques/d3f:One-timePassword)
* [Multi-factor Authentication](https://d3fend.mitre.org/techniques/d3f:Multi-factorAuthentication)
* [User Account Permissions](https://d3fend.mitre.org/techniques/d3f:UserAccountPermissions)
* [Domain Account Monitoring](https://d3fend.mitre.org/techniques/d3f:DomainAccountMonitoring)
* [Credential Transmission Scoping](https://d3fend.mitre.org/techniques/d3f:CredentialTransmissionScoping)
* [Account Locking](https://d3fend.mitre.org/techniques/d3f:AccountLocking)
* [Authentication Cache Invalidation](https://d3fend.mitre.org/techniques/d3f:AuthenticationCacheInvalidation)
* [Decoy User Credential](https://d3fend.mitre.org/techniques/d3f:DecoyUserCredential)
* [Inbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:InboundTrafficFiltering)
* [Outbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:OutboundTrafficFiltering)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-04-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-04-002.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:** 16

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/cloud/aws/aws_iam_backdoor_users_keys.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/aws_iam_backdoor_users_keys.yml)
* [sigma/rules/cloud/aws/aws_route_53_domain_transferred_lock_disabled.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/aws_route_53_domain_transferred_lock_disabled.yml)
* [sigma/rules/cloud/aws/aws_route_53_domain_transferred_to_another_account.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/aws_route_53_domain_transferred_to_another_account.yml)
* [sigma/rules/cloud/aws/aws_update_login_profile.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/aws_update_login_profile.yml)
* [sigma/rules/cloud/azure/azure_creating_number_of_resources_detection.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/azure/azure_creating_number_of_resources_detection.yml)
* [sigma/rules/cloud/azure/azure_granting_permission_detection.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/azure/azure_granting_permission_detection.yml)
* [sigma/rules/cloud/gworkspace/gworkspace_granted_domain_api_access.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/gworkspace/gworkspace_granted_domain_api_access.yml)
* [sigma/rules/cloud/gworkspace/gworkspace_user_granted_admin_privileges.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/gworkspace/gworkspace_user_granted_admin_privileges.yml)
* [sigma/rules/network/cisco/aaa/cisco_cli_local_accounts.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/network/cisco/aaa/cisco_cli_local_accounts.yml)
* [sigma/rules/windows/builtin/security/win_account_backdoor_dcsync_rights.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_account_backdoor_dcsync_rights.yml)
* [sigma/rules/windows/builtin/security/win_alert_active_directory_user_control.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_alert_active_directory_user_control.yml)
* [sigma/rules/windows/builtin/security/win_alert_ad_user_backdoors.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_alert_ad_user_backdoors.yml)
* [sigma/rules/windows/builtin/security/win_susp_add_domain_trust.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_susp_add_domain_trust.yml)
* [sigma/rules/windows/builtin/security/win_susp_dsrm_password_change.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_susp_dsrm_password_change.yml)
* [sigma/rules/windows/builtin/security/win_user_added_to_local_administrators.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_user_added_to_local_administrators.yml)
* [sigma/rules/windows/powershell/powershell_script/posh_ps_localuser.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_localuser.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:** 17

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/cloud/aws_iam_successful_group_deletion.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_iam_successful_group_deletion.yml)
* [security_content/detections/cloud/aws_iam_delete_policy.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_iam_delete_policy.yml)
* [security_content/detections/cloud/aws_iam_failure_group_deletion.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_iam_failure_group_deletion.yml)
* [security_content/detections/deprecated/ssa___setting_credentials_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___setting_credentials_via_powersploit_modules.yml)
* [security_content/detections/deprecated/ssa___applying_stolen_credentials_via_mimikatz_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___applying_stolen_credentials_via_mimikatz_modules.yml)
* [security_content/detections/deprecated/ssa___probing_access_with_stolen_credentials_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___probing_access_with_stolen_credentials_via_powersploit_modules.yml)
* [security_content/detections/deprecated/ssa___illegal_account_enable_disable_via_dsinternals_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___illegal_account_enable_disable_via_dsinternals_modules.yml)
* [security_content/detections/deprecated/ssa___recon_credential_stores_and_services_via_mimikatz_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___recon_credential_stores_and_services_via_mimikatz_modules.yml)
* [security_content/detections/deprecated/ssa___illegal_management_AD_elements_and_policies_via_dsinternals_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___illegal_management_AD_elements_and_policies_via_dsinternals_modules.yml)
* [security_content/detections/deprecated/ssa___applying_stolen_credentials_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___applying_stolen_credentials_via_powersploit_modules.yml)
* [security_content/detections/deprecated/ssa___illegal_management_computers_and_AD_elements_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___illegal_management_computers_and_AD_elements_via_powersploit_modules.yml)
* [security_content/detections/deprecated/ssa___assess_credential_strength_via_dsinternals_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___assess_credential_strength_via_dsinternals_modules.yml)
* [security_content/detections/deprecated/ssa___recon_privilege_escalation_opportunities_via_powersploit_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___recon_privilege_escalation_opportunities_via_powersploit_modules.yml)
* [security_content/detections/deprecated/ssa___setting_credentials_via_mimikatz_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___setting_credentials_via_mimikatz_modules.yml)
* [security_content/detections/deprecated/ssa___setting_credentials_via_dsinternals_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___setting_credentials_via_dsinternals_modules.yml)
* [security_content/detections/endpoint/linux_possible_access_or_modification_of_sshd_config_file.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/linux_possible_access_or_modification_of_sshd_config_file.yml)
* [security_content/detections/endpoint/linux_possible_ssh_key_file_creation.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/linux_possible_ssh_key_file_creation.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:** 8

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1098/T1098.yaml):

* Admin Account Manipulate
* Domain Account and Group Manipulate
* AWS - Create a group and add a user to that group
* Azure - adding user to Azure AD role
* Azure - adding service principal to Azure AD role
* Azure - adding user to Azure role in subscription
* Azure - adding service principal to Azure role in subscription
* AzureAD - adding permission to application

### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 28, 2022

**Total ATT&CK-mapped tests:** 70

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-04-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-04-002.yaml): 1 <code>unit_tests</code>

