# T1098.001: Additional Cloud Credentials
**MITRE ATT&CK Tactic(s):** Persistence

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1098/001)**
<blockquote>Adversaries may add adversary-controlled credentials to a cloud account to maintain persistent access to victim accounts and instances within the environment.

Adversaries may add credentials for Service Principals and Applications in addition to existing legitimate credentials in Azure AD.(Citation: Microsoft SolarWinds Customer Guidance)(Citation: Blue Cloud of Death)(Citation: Blue Cloud of Death Video) These credentials include both x509 keys and passwords.(Citation: Microsoft SolarWinds Customer Guidance) With sufficient permissions, there are a variety of ways to add credentials including the Azure Portal, Azure command line interface, and Azure or Az PowerShell modules.(Citation: Demystifying Azure AD Service Principals)

In infrastructure-as-a-service (IaaS) environments, after gaining access through [Cloud Accounts](https://attack.mitre.org/techniques/T1078/004), adversaries may generate or import their own SSH keys using either the <code>CreateKeyPair</code> or <code>ImportKeyPair</code> API in AWS or the <code>gcloud compute os-login ssh-keys add</code> command in GCP.(Citation: GCP SSH Key Add) This allows persistent access to instances within the cloud environment without further usage of the compromised cloud accounts.(Citation: Expel IO Evil in AWS)(Citation: Expel Behind the Scenes)</blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 19

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Credential Compromise Scope Analysis](https://d3fend.mitre.org/techniques/d3f:CredentialCompromiseScopeAnalysis)
* [User Geolocation Logon Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:UserGeolocationLogonPatternAnalysis)
* [Decoy User Credential](https://d3fend.mitre.org/techniques/d3f:DecoyUserCredential)
* [Connection Attempt Analysis](https://d3fend.mitre.org/techniques/d3f:ConnectionAttemptAnalysis)
* [Network Traffic Community Deviation](https://d3fend.mitre.org/techniques/d3f:NetworkTrafficCommunityDeviation)
* [Per Host Download-Upload Ratio Analysis](https://d3fend.mitre.org/techniques/d3f:PerHostDownload-UploadRatioAnalysis)
* [Inbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:InboundTrafficFiltering)
* [Outbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:OutboundTrafficFiltering)
* [Protocol Metadata Anomaly Detection](https://d3fend.mitre.org/techniques/d3f:ProtocolMetadataAnomalyDetection)
* [Client-server Payload Profiling](https://d3fend.mitre.org/techniques/d3f:Client-serverPayloadProfiling)
* [Remote Terminal Session Detection](https://d3fend.mitre.org/techniques/d3f:RemoteTerminalSessionDetection)
* [Administrative Network Activity Analysis](https://d3fend.mitre.org/techniques/d3f:AdministrativeNetworkActivityAnalysis)
* [Authentication Cache Invalidation](https://d3fend.mitre.org/techniques/d3f:AuthenticationCacheInvalidation)
* [Account Locking](https://d3fend.mitre.org/techniques/d3f:AccountLocking)
* [Credential Transmission Scoping](https://d3fend.mitre.org/techniques/d3f:CredentialTransmissionScoping)
* [Multi-factor Authentication](https://d3fend.mitre.org/techniques/d3f:Multi-factorAuthentication)
* [One-time Password](https://d3fend.mitre.org/techniques/d3f:One-timePassword)
* [Strong Password Policy](https://d3fend.mitre.org/techniques/d3f:StrongPasswordPolicy)
* [User Account Permissions](https://d3fend.mitre.org/techniques/d3f:UserAccountPermissions)

## Technical Controls (Detection Rules)

## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** May 16, 2022

**Total ATT&CK-mapped tests:** 1258

**ATT&CK-mapped resources for this (sub)technique:** 3

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1098.001/T1098.001.yaml):

* Azure AD Application Hijacking - Service Principal
* Azure AD Application Hijacking - App Registration
* AWS - Create Access Key and Secret Key

### [Stratus Red Team](https://github.com/DataDog/stratus-red-team/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped tests:** 21

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://stratus-red-team.cloud/attack-techniques/):

* [aws.persistence.iam-backdoor-user](https://stratus-red-team.cloud/attack-techniques/aws/aws.persistence.iam-backdoor-user/)

