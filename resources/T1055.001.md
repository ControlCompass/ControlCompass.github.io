# T1055.001: Dynamic-link Library Injection
**MITRE ATT&CK Tactic(s):** Defense Evasion, Privilege Escalation

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1055/001)**
<blockquote>Adversaries may inject dynamic-link libraries (DLLs) into processes in order to evade process-based defenses as well as possibly elevate privileges. DLL injection is a method of executing arbitrary code in the address space of a separate live process.  

DLL injection is commonly performed by writing the path to a DLL in the virtual address space of the target process before loading the DLL by invoking a new thread. The write can be performed with native Windows API calls such as <code>VirtualAllocEx</code> and <code>WriteProcessMemory</code>, then invoked with <code>CreateRemoteThread</code> (which calls the <code>LoadLibrary</code> API responsible for loading the DLL). (Citation: Elastic Process Injection July 2017) 

Variations of this method such as reflective DLL injection (writing a self-mapping DLL into a process) and memory module (map DLL when writing into process) overcome the address relocation issue as well as the additional APIs to invoke execution (since these methods load and execute the files in memory by manually preforming the function of <code>LoadLibrary</code>).(Citation: Elastic HuntingNMemory June 2017)(Citation: Elastic Process Injection July 2017) 

Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via DLL injection may also evade detection from security products since the execution is masked under a legitimate process. </blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**5

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)
* [System Call Analysis](https://d3fend.mitre.org/techniques/d3f:SystemCallAnalysis)
* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)
* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)
* [System Call Filtering](https://d3fend.mitre.org/techniques/d3f:SystemCallFiltering)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:**2

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-10-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-10-002.yaml)
* [car/analytics/CAR-2020-11-003.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2020-11-003.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**8

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/windows/create_remote_thread/sysmon_cobaltstrike_process_injection.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/create_remote_thread/sysmon_cobaltstrike_process_injection.yml)
* [sigma/rules/windows/create_remote_thread/sysmon_createremotethread_loadlibrary.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/create_remote_thread/sysmon_createremotethread_loadlibrary.yml)
* [sigma/rules/windows/process_access/proc_access_win_in_memory_assembly_execution.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_in_memory_assembly_execution.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_taidoor.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_taidoor.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_mavinject_proc_inj.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mavinject_proc_inj.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_dctask64_proc_inject.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_dctask64_proc_inject.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_renamed_dctask64.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_renamed_dctask64.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_tracker_execution.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_tracker_execution.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**3

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/loading_of_dynwrapx_module.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/loading_of_dynwrapx_module.yml)
* [security_content/detections/endpoint/windows_rasautou_dll_execution.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_rasautou_dll_execution.yml)
* [security_content/detections/endpoint/ssa___windows_rasautou_dll_execution.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ssa___windows_rasautou_dll_execution.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**2

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1055.001/T1055.001.yaml):

* Process Injection via mavinject.exe
* Process Injection via mavinject.exe

