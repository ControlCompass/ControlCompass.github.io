# T1490: Inhibit System Recovery
**MITRE ATT&CK Tactic(s):** Impact

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1490)**
<blockquote>Adversaries may delete or remove built-in operating system data and turn off services designed to aid in the recovery of a corrupted system to prevent recovery.(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017) Operating systems may contain features that can help fix corrupted systems, such as a backup catalog, volume shadow copies, and automatic repair features. Adversaries may disable or delete system recovery features to augment the effects of [Data Destruction](https://attack.mitre.org/techniques/T1485) and [Data Encrypted for Impact](https://attack.mitre.org/techniques/T1486).(Citation: Talos Olympic Destroyer 2018)(Citation: FireEye WannaCry 2017)

A number of native Windows utilities have been used by adversaries to disable or delete system recovery features:

* <code>vssadmin.exe</code> can be used to delete all volume shadow copies on a system - <code>vssadmin.exe delete shadows /all /quiet</code>
* [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) can be used to delete volume shadow copies - <code>wmic shadowcopy delete</code>
* <code>wbadmin.exe</code> can be used to delete the Windows Backup Catalog - <code>wbadmin.exe delete catalog -quiet</code>
* <code>bcdedit.exe</code> can be used to disable automatic Windows recovery features by modifying boot configuration data - <code>bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no</code></blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [no defensive relations yet](https://d3fend.mitre.org/techniques/d3f:nodefensiverelationsyet)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:**2

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2021-01-009.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-01-009.yaml)
* [car/analytics/CAR-2021-05-003.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-05-003.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**15

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/network/cisco/aaa/cisco_cli_modify_config.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/network/cisco/aaa/cisco_cli_modify_config.yml)
* [sigma/rules/windows/file_delete/file_delete_win_delete_backup_file.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_delete/file_delete_win_delete_backup_file.yml)
* [sigma/rules/windows/image_load/image_load_suspicious_vss_ps_load.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_suspicious_vss_ps_load.yml)
* [sigma/rules/windows/powershell/powershell_classic/posh_pc_delete_volume_shadow_copies.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_classic/posh_pc_delete_volume_shadow_copies.yml)
* [sigma/rules/windows/powershell/powershell_script/posh_ps_susp_win32_shadowcopy.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_susp_win32_shadowcopy.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_bootconf_mod.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_bootconf_mod.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_crime_maze_ransomware.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_crime_maze_ransomware.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_delete_systemstatebackup.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_delete_systemstatebackup.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_malware_conti_shadowcopy.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_malware_conti_shadowcopy.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_malware_dtrack.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_malware_dtrack.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_malware_wannacry.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_malware_wannacry.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_shadow_copies_deletion.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_shadow_copies_deletion.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_cmd_shadowcopy_access.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_cmd_shadowcopy_access.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_disable_system_restore.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_disable_system_restore.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_install_root_or_ca_certificat.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_install_root_or_ca_certificat.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**11

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/ssa___bcdedit_failure_recovery_modification.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ssa___bcdedit_failure_recovery_modification.yml)
* [security_content/detections/endpoint/resize_shadowstorage_volume.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/resize_shadowstorage_volume.yml)
* [security_content/detections/endpoint/ssa___wbadmin_delete_system_backups.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ssa___wbadmin_delete_system_backups.yml)
* [security_content/detections/endpoint/change_to_safe_mode_with_network_config.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/change_to_safe_mode_with_network_config.yml)
* [security_content/detections/endpoint/prevent_automatic_repair_mode_using_bcdedit.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/prevent_automatic_repair_mode_using_bcdedit.yml)
* [security_content/detections/endpoint/bcdedit_command_back_to_normal_mode_boot.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/bcdedit_command_back_to_normal_mode_boot.yml)
* [security_content/detections/endpoint/deleting_shadow_copies.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/deleting_shadow_copies.yml)
* [security_content/detections/endpoint/known_services_killed_by_ransomware.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/known_services_killed_by_ransomware.yml)
* [security_content/detections/endpoint/delete_shadowcopy_with_powershell.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/delete_shadowcopy_with_powershell.yml)
* [security_content/detections/endpoint/wbadmin_delete_system_backups.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/wbadmin_delete_system_backups.yml)
* [security_content/detections/endpoint/bcdedit_failure_recovery_modification.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/bcdedit_failure_recovery_modification.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**9

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1490/T1490.yaml):

* Windows - Delete Volume Shadow Copies
* Windows - Delete Volume Shadow Copies via WMI
* Windows - wbadmin Delete Windows Backup Catalog
* Windows - Disable Windows Recovery Console Repair
* Windows - Delete Volume Shadow Copies via WMI with PowerShell
* Windows - Delete Backup Files
* Windows - wbadmin Delete systemstatebackup
* Windows - Disable the SR scheduled task
* Disable System Restore Through Registry

### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 70

**ATT&CK-mapped resources for this (sub)technique:**2

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2021-01-009.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-01-009.yaml): 3 <code>unit_tests</code>
* [car/analytics/CAR-2021-05-003.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-05-003.yaml): 2 <code>unit_tests</code>

