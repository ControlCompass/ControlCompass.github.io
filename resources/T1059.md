# T1059: Command and Scripting Interpreter
**MITRE ATT&CK Tactic(s):** Execution

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1059)**
<blockquote>Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, macOS and Linux distributions include some flavor of [Unix Shell](https://attack.mitre.org/techniques/T1059/004) while Windows installations include the [Windows Command Shell](https://attack.mitre.org/techniques/T1059/003) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).

There are also cross-platform interpreters such as [Python](https://attack.mitre.org/techniques/T1059/006), as well as those commonly associated with client applications such as [JavaScript](https://attack.mitre.org/techniques/T1059/007) and [Visual Basic](https://attack.mitre.org/techniques/T1059/005).

Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0001) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells, as well as utilize various [Remote Services](https://attack.mitre.org/techniques/T1021) in order to achieve remote Execution.(Citation: Powershell Remote Commands)(Citation: Cisco IOS Software Integrity Assurance - Command History)(Citation: Remote Shell Execution in Python)</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**7

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Executable Denylisting](https://d3fend.mitre.org/techniques/d3f:ExecutableDenylisting)
* [Executable Allowlisting](https://d3fend.mitre.org/techniques/d3f:ExecutableAllowlisting)
* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)
* [Dynamic Analysis](https://d3fend.mitre.org/techniques/d3f:DynamicAnalysis)
* [Emulated File Analysis](https://d3fend.mitre.org/techniques/d3f:EmulatedFileAnalysis)
* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)
* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2021-01-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-01-002.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**30

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/cloud/azure/azure_new_cloudshell_created.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/azure/azure_new_cloudshell_created.yml)
* [sigma/rules/windows/builtin/security/win_alert_ruler.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_alert_ruler.yml)
* [sigma/rules/windows/builtin/security/win_lateral_movement_condrv.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_lateral_movement_condrv.yml)
* [sigma/rules/windows/builtin/windefend/win_defender_amsi_trigger.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/windefend/win_defender_amsi_trigger.yml)
* [sigma/rules/windows/builtin/windefend/win_defender_threat.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/windefend/win_defender_threat.yml)
* [sigma/rules/windows/file_event/file_event_win_pcre_net_temp_file.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_pcre_net_temp_file.yml)
* [sigma/rules/windows/image_load/image_load_pcre_net_load.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_pcre_net_load.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_lazarus_activity_dec20.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_lazarus_activity_dec20.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_lazarus_loader.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_lazarus_loader.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_revil_kaseya.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_revil_kaseya.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_turla_commands_critical.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_turla_commands_critical.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_turla_commands_medium.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_turla_commands_medium.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_atlassian_confluence_cve_2021_26084_exploit.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_atlassian_confluence_cve_2021_26084_exploit.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_cmd_dosfuscation.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_dosfuscation.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_cobaltstrike_process_patterns.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cobaltstrike_process_patterns.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_fsutil_symlinkevaluation.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_fsutil_symlinkevaluation.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_hiding_malware_in_fonts_folder.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_hiding_malware_in_fonts_folder.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_lolbin_execution_via_winget.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_lolbin_execution_via_winget.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_multiple_suspicious_cli.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_multiple_suspicious_cli.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_network_scan_loop.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_network_scan_loop.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_run_powershell_script_from_input_stream.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_run_powershell_script_from_input_stream.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_control_cve_2021_40444.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_control_cve_2021_40444.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_ftp.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_ftp.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_outlook.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_outlook.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_rasdial_activity.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_rasdial_activity.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_runscripthelper.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_runscripthelper.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_script_exec_from_env_folder.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_script_exec_from_env_folder.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_script_exec_from_temp.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_script_exec_from_temp.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_sysprep_appdata.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_sysprep_appdata.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_vmtoolsd_susp_child_process.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_vmtoolsd_susp_child_process.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**37

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/deprecated/ssa___assess_credential_strength_via_dsinternals_modules.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/ssa___assess_credential_strength_via_dsinternals_modules.yml)
* [security_content/detections/network/detect_outbound_ldap_traffic.yml](https://github.com/splunk/security_content/blob/develop/detections/network/detect_outbound_ldap_traffic.yml)
* [security_content/detections/network/ssa___tcp_command_and_scripting_interpreter_outbound_ldap_traffic.yml](https://github.com/splunk/security_content/blob/develop/detections/network/ssa___tcp_command_and_scripting_interpreter_outbound_ldap_traffic.yml)
* [security_content/detections/endpoint/powershell_domain_enumeration.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/powershell_domain_enumeration.yml)
* [security_content/detections/endpoint/any_powershell_downloadfile.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/any_powershell_downloadfile.yml)
* [security_content/detections/endpoint/execute_javascript_with_jscript_com_clsid.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/execute_javascript_with_jscript_com_clsid.yml)
* [security_content/detections/endpoint/log4shell_cve_2021_44228_exploitation.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/log4shell_cve_2021_44228_exploitation.yml)
* [security_content/detections/endpoint/powershell_fileless_script_contains_base64_encoded_content.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/powershell_fileless_script_contains_base64_encoded_content.yml)
* [security_content/detections/endpoint/malicious_powershell_process_with_obfuscation_techniques.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/malicious_powershell_process_with_obfuscation_techniques.yml)
* [security_content/detections/endpoint/cmdline_tool_not_executed_in_cmd_shell.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/cmdline_tool_not_executed_in_cmd_shell.yml)
* [security_content/detections/endpoint/detect_empire_with_powershell_script_block_logging.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_empire_with_powershell_script_block_logging.yml)
* [security_content/detections/endpoint/powershell___connect_to_internet_with_hidden_window.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/powershell___connect_to_internet_with_hidden_window.yml)
* [security_content/detections/endpoint/nishang_powershelltcponeline.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/nishang_powershelltcponeline.yml)
* [security_content/detections/endpoint/cmd_carry_out_string_command_parameter.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/cmd_carry_out_string_command_parameter.yml)
* [security_content/detections/endpoint/process_writing_dynamicwrapperx.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/process_writing_dynamicwrapperx.yml)
* [security_content/detections/endpoint/powershell_loading_dotnet_into_memory_via_system_reflection_assembly.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/powershell_loading_dotnet_into_memory_via_system_reflection_assembly.yml)
* [security_content/detections/endpoint/jscript_execution_using_cscript_app.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/jscript_execution_using_cscript_app.yml)
* [security_content/detections/endpoint/malicious_powershell_process___execution_policy_bypass.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/malicious_powershell_process___execution_policy_bypass.yml)
* [security_content/detections/endpoint/set_default_powershell_execution_policy_to_unrestricted_or_bypass.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/set_default_powershell_execution_policy_to_unrestricted_or_bypass.yml)
* [security_content/detections/endpoint/detect_prohibited_applications_spawning_cmd_exe.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_prohibited_applications_spawning_cmd_exe.yml)
* [security_content/detections/endpoint/suspicious_process_dns_query_known_abuse_web_services.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_process_dns_query_known_abuse_web_services.yml)
* [security_content/detections/endpoint/ssa___unusual_lolbas_in_short_period_of_time.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ssa___unusual_lolbas_in_short_period_of_time.yml)
* [security_content/detections/endpoint/powershell_processing_stream_of_data.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/powershell_processing_stream_of_data.yml)
* [security_content/detections/endpoint/detect_use_of_cmd_exe_to_launch_script_interpreters.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/detect_use_of_cmd_exe_to_launch_script_interpreters.yml)
* [security_content/detections/endpoint/vbscript_execution_using_wscript_app.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/vbscript_execution_using_wscript_app.yml)
* [security_content/detections/endpoint/wermgr_process_spawned_cmd_or_powershell_process.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/wermgr_process_spawned_cmd_or_powershell_process.yml)
* [security_content/detections/endpoint/powershell_fileless_process_injection_via_getprocaddress.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/powershell_fileless_process_injection_via_getprocaddress.yml)
* [security_content/detections/endpoint/ms_scripting_process_loading_wmi_module.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ms_scripting_process_loading_wmi_module.yml)
* [security_content/detections/endpoint/excessive_number_of_distinct_processes_created_in_windows_temp_folder.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/excessive_number_of_distinct_processes_created_in_windows_temp_folder.yml)
* [security_content/detections/endpoint/any_powershell_downloadstring.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/any_powershell_downloadstring.yml)
* [security_content/detections/endpoint/ryuk_wake_on_lan_command.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ryuk_wake_on_lan_command.yml)
* [security_content/detections/endpoint/suspicious_process_with_discord_dns_query.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_process_with_discord_dns_query.yml)
* [security_content/detections/endpoint/powershell_4104_hunting.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/powershell_4104_hunting.yml)
* [security_content/detections/endpoint/chcp_command_execution.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/chcp_command_execution.yml)
* [security_content/detections/endpoint/ssa___prohibited_apps_spawning_cmdprompt.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ssa___prohibited_apps_spawning_cmdprompt.yml)
* [security_content/detections/endpoint/ms_scripting_process_loading_ldap_module.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ms_scripting_process_loading_ldap_module.yml)
* [security_content/detections/endpoint/cmd_echo_pipe___escalation.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/cmd_echo_pipe___escalation.yml)


## Offensive Security Tests
