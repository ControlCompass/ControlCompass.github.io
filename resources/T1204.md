# T1204: User Execution
**MITRE ATT&CK Tactic(s):** Execution

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1204)**
<blockquote>An adversary may rely upon specific actions by a user in order to gain execution. Users may be subjected to social engineering to get them to execute malicious code by, for example, opening a malicious document file or link. These user actions will typically be observed as follow-on behavior from forms of [Phishing](https://attack.mitre.org/techniques/T1566).

While [User Execution](https://attack.mitre.org/techniques/T1204) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](https://attack.mitre.org/techniques/T1534).</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**18

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [User Geolocation Logon Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:UserGeolocationLogonPatternAnalysis)
* [Client-server Payload Profiling](https://d3fend.mitre.org/techniques/d3f:Client-serverPayloadProfiling)
* [Network Traffic Community Deviation](https://d3fend.mitre.org/techniques/d3f:NetworkTrafficCommunityDeviation)
* [Per Host Download-Upload Ratio Analysis](https://d3fend.mitre.org/techniques/d3f:PerHostDownload-UploadRatioAnalysis)
* [Relay Pattern Analysis](https://d3fend.mitre.org/techniques/d3f:RelayPatternAnalysis)
* [Remote Terminal Session Detection](https://d3fend.mitre.org/techniques/d3f:RemoteTerminalSessionDetection)
* [Protocol Metadata Anomaly Detection](https://d3fend.mitre.org/techniques/d3f:ProtocolMetadataAnomalyDetection)
* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)
* [URL Analysis](https://d3fend.mitre.org/techniques/d3f:URLAnalysis)
* [Homoglyph Detection](https://d3fend.mitre.org/techniques/d3f:HomoglyphDetection)
* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)
* [Dynamic Analysis](https://d3fend.mitre.org/techniques/d3f:DynamicAnalysis)
* [Emulated File Analysis](https://d3fend.mitre.org/techniques/d3f:EmulatedFileAnalysis)
* [Outbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:OutboundTrafficFiltering)
* [Inbound Traffic Filtering](https://d3fend.mitre.org/techniques/d3f:InboundTrafficFiltering)
* [Executable Allowlisting](https://d3fend.mitre.org/techniques/d3f:ExecutableAllowlisting)
* [Executable Denylisting](https://d3fend.mitre.org/techniques/d3f:ExecutableDenylisting)
* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)

## Technical Controls (Detection Rules)
### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**7

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/application/antivirus/av_hacktool.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/application/antivirus/av_hacktool.yml)
* [sigma/rules/windows/process_creation/process_creation_win_arbitrary_shell_execution_via_settingcontent.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/process_creation_win_arbitrary_shell_execution_via_settingcontent.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_crime_snatch_ransomware.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_crime_snatch_ransomware.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_mal_darkside_ransomware.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mal_darkside_ransomware.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_mal_ryuk.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mal_ryuk.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_run_folder.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_run_folder.yml)
* [sigma/rules/windows/registry/registry_event/registry_event_mimikatz_printernightmare.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_mimikatz_printernightmare.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**14

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/cloud/aws_ecr_container_scanning_findings_medium.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_ecr_container_scanning_findings_medium.yml)
* [security_content/detections/cloud/aws_ecr_container_scanning_findings_low_informational_unknown.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_ecr_container_scanning_findings_low_informational_unknown.yml)
* [security_content/detections/cloud/aws_ecr_container_upload_outside_business_hours.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_ecr_container_upload_outside_business_hours.yml)
* [security_content/detections/cloud/aws_ecr_container_scanning_findings_high.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_ecr_container_scanning_findings_high.yml)
* [security_content/detections/cloud/aws_lambda_updatefunctioncode.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_lambda_updatefunctioncode.yml)
* [security_content/detections/cloud/correlation_by_user_and_risk.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/correlation_by_user_and_risk.yml)
* [security_content/detections/cloud/correlation_by_repository_and_risk.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/correlation_by_repository_and_risk.yml)
* [security_content/detections/cloud/aws_ecr_container_upload_unknown_user.yml](https://github.com/splunk/security_content/blob/develop/detections/cloud/aws_ecr_container_upload_unknown_user.yml)
* [security_content/detections/endpoint/revil_common_exec_parameter.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/revil_common_exec_parameter.yml)
* [security_content/detections/endpoint/clop_common_exec_parameter.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/clop_common_exec_parameter.yml)
* [security_content/detections/endpoint/batch_file_write_to_system32.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/batch_file_write_to_system32.yml)
* [security_content/detections/endpoint/drop_icedid_license_dat.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/drop_icedid_license_dat.yml)
* [security_content/detections/endpoint/conti_common_exec_parameter.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/conti_common_exec_parameter.yml)
* [security_content/detections/endpoint/single_letter_process_on_endpoint.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/single_letter_process_on_endpoint.yml)


## Offensive Security Tests
