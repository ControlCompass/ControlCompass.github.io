# T1562.004: Disable or Modify System Firewall
**MITRE ATT&CK Tactic(s):** Defense Evasion

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1562/004)**
<blockquote>Adversaries may disable or modify system firewalls in order to bypass controls limiting network usage. Changes could be disabling the entire mechanism as well as adding, deleting, or modifying particular rules. This can be done numerous ways depending on the operating system, including via command-line, editing Windows Registry keys, and Windows Control Panel.

Modifying or disabling a system firewall may enable adversary C2 communications, lateral movement, and/or data exfiltration that would otherwise not be allowed. </blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [no defensive relations yet](https://d3fend.mitre.org/techniques/d3f:nodefensiverelationsyet)

## Technical Controls (Detection Rules)
### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:** 10

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/linux/auditd/lnx_auditd_disable_system_firewall.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_disable_system_firewall.yml)
* [sigma/rules/linux/other/lnx_security_tools_disabling_syslog.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/other/lnx_security_tools_disabling_syslog.yml)
* [sigma/rules/linux/process_creation/proc_creation_lnx_security_tools_disabling.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_security_tools_disabling.yml)
* [sigma/rules/windows/powershell/powershell_script/posh_ps_windows_firewall_profile_disabled.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_windows_firewall_profile_disabled.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_netsh_allow_port_rdp.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_allow_port_rdp.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_add.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_fw_add.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_add_susp_image.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_fw_add_susp_image.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_netsh_fw_enable_group_rule.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_netsh_fw_enable_group_rule.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_firewall_disable.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_firewall_disable.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_disable_defender_firewall.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_disable_defender_firewall.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:** 3

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/deprecated/processes_created_by_netsh.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/processes_created_by_netsh.yml)
* [security_content/detections/endpoint/firewall_allowed_program_enable.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/firewall_allowed_program_enable.yml)
* [security_content/detections/endpoint/processes_launching_netsh.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/processes_launching_netsh.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:** 15

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1562.004/T1562.004.yaml):

* Disable Microsoft Defender Firewall
* Disable Microsoft Defender Firewall via Registry
* Allow SMB and RDP on Microsoft Defender Firewall
* Opening ports for proxy - HARDRAIN
* Open a local port through Windows Firewall to any profile
* Allow Executable Through Firewall Located in Non-Standard Location
* Stop/Start UFW firewall
* Stop/Start UFW firewall systemctl
* Turn off UFW logging
* Add and delete UFW firewall rules
* Edit UFW firewall user.rules file
* Edit UFW firewall ufw.conf file
* Edit UFW firewall sysctl.conf file
* Edit UFW firewall main configuration file
* Tail the UFW firewall log file

