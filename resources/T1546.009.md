# T1546.009: AppCert DLLs
**MITRE ATT&CK Tactic(s):** Privilege Escalation, Persistence

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1546/009)**
<blockquote>Adversaries may establish persistence and/or elevate privileges by executing malicious content triggered by AppCert DLLs loaded into processes. Dynamic-link libraries (DLLs) that are specified in the <code>AppCertDLLs</code> Registry key under <code>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager\</code> are loaded into every process that calls the ubiquitously used application programming interface (API) functions <code>CreateProcess</code>, <code>CreateProcessAsUser</code>, <code>CreateProcessWithLoginW</code>, <code>CreateProcessWithTokenW</code>, or <code>WinExec</code>. (Citation: Elastic Process Injection July 2017)

Similar to [Process Injection](https://attack.mitre.org/techniques/T1055), this value can be abused to obtain elevated privileges by causing a malicious DLL to be loaded and run in the context of separate processes on the computer. Malicious AppCert DLLs may also provide persistence by continuously being triggered by API activity. </blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** May 23, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 6

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Process Spawn Analysis](https://d3fend.mitre.org/technique/d3f:ProcessSpawnAnalysis)
* [File Analysis](https://d3fend.mitre.org/technique/d3f:FileAnalysis)
* [Local File Permissions](https://d3fend.mitre.org/technique/d3f:LocalFilePermissions)
* [Decoy File](https://d3fend.mitre.org/technique/d3f:DecoyFile)
* [System Call Analysis](https://d3fend.mitre.org/technique/d3f:SystemCallAnalysis)
* [System Call Filtering](https://d3fend.mitre.org/technique/d3f:SystemCallFiltering)

## Technical Controls (Detection Rules)
### [Elastic Detection Rules](https://github.com/elastic/detection-rules)
**Last accessed:** May 23, 2022

**Total ATT&CK-mapped rules:** 560

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[rules](https://github.com/elastic/detection-rules/tree/main/rules)</code> folder:

* [windows](https://github.com/elastic/detection-rules/tree/main/rules/windows/) / **[Registry Persistence via AppCert DLL](https://github.com/elastic/detection-rules/blob/main/rules/windows/persistence_appcertdlls_registry.toml)**

### [Microsoft Sentinel and Microsoft 365 Defender repository](https://github.com/Azure/Azure-Sentinel)
**Last accessed:** May 21, 2022

**Total ATT&CK-mapped rules:** 383

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[Detections](https://github.com/Azure/Azure-Sentinel/tree/master/Detections)</code> folder:

* [SecurityEvent](https://github.com/Azure/Azure-Sentinel/tree/master/Detections/SecurityEvent/) / **[Registry Persistence via AppCert DLL Modification](https://github.com/Azure/Azure-Sentinel/blob/master/Detections/SecurityEvent/RegistryPersistenceViaAppCertDLLModification.yaml)**

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** May 23, 2022

**Total ATT&CK-mapped rules:** 2360

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[rules](https://github.com/SigmaHQ/sigma/tree/master/rules)</code> folder:

* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [registry](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/) / [registry_event](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/) / **[New DLL Added to AppCertDlls Registry Key](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_new_dll_added_to_appcertdlls_registry_key.yml)**


## Offensive Security Tests
