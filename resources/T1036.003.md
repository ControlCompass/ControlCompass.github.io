# T1036.003: Rename System Utilities
**MITRE ATT&CK Tactic(s):** Defense Evasion

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1036/003)**
<blockquote>Adversaries may rename legitimate system utilities to try to evade security mechanisms concerning the usage of those utilities. Security monitoring and control mechanisms may be in place for system utilities adversaries are capable of abusing. (Citation: LOLBAS Main Site) It may be possible to bypass those security mechanisms by renaming the utility prior to utilization (ex: rename <code>rundll32.exe</code>). (Citation: Elastic Masquerade Ball) An alternative case occurs when a legitimate utility is copied or moved to a different directory and renamed to avoid detections based on system utilities executing from non-standard paths. (Citation: F-Secure CozyDuke)</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**8

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)
* [Executable Allowlisting](https://d3fend.mitre.org/techniques/d3f:ExecutableAllowlisting)
* [System File Analysis](https://d3fend.mitre.org/techniques/d3f:SystemFileAnalysis)
* [Executable Denylisting](https://d3fend.mitre.org/techniques/d3f:ExecutableDenylisting)
* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)
* [Emulated File Analysis](https://d3fend.mitre.org/techniques/d3f:EmulatedFileAnalysis)
* [Dynamic Analysis](https://d3fend.mitre.org/techniques/d3f:DynamicAnalysis)
* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-05-009.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-05-009.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**13

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/linux/auditd/lnx_auditd_masquerading_crond.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/auditd/lnx_auditd_masquerading_crond.yml)
* [sigma/rules/windows/powershell/powershell_script/posh_ps_suspicious_start_process.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_suspicious_start_process.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_ta17_293a_ps.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_ta17_293a_ps.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_bitsadmin_download.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_bitsadmin_download.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_proc_wrong_parent.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_proc_wrong_parent.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_renamed_binary.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_binary.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_renamed_binary_highly_relevant.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_binary_highly_relevant.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_renamed_jusched.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_jusched.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_renamed_paexec.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_paexec.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_renamed_powershell.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_powershell.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_renamed_procdump.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_procdump.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_renamed_psexec.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_renamed_psexec.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_copy_system32.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_copy_system32.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**10

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/deprecated/suspicious_rundll32_rename.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/suspicious_rundll32_rename.yml)
* [security_content/detections/deprecated/execution_of_file_with_spaces_before_extension.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/execution_of_file_with_spaces_before_extension.yml)
* [security_content/detections/endpoint/suspicious_msbuild_rename.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_msbuild_rename.yml)
* [security_content/detections/endpoint/suspicious_microsoft_workflow_compiler_rename.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_microsoft_workflow_compiler_rename.yml)
* [security_content/detections/endpoint/execution_of_file_with_multiple_extensions.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/execution_of_file_with_multiple_extensions.yml)
* [security_content/detections/endpoint/suspicious_copy_on_system32.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_copy_on_system32.yml)
* [security_content/detections/endpoint/windows_dotnet_binary_in_non_standard_path.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_dotnet_binary_in_non_standard_path.yml)
* [security_content/detections/endpoint/windows_installutil_in_non_standard_path.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_installutil_in_non_standard_path.yml)
* [security_content/detections/endpoint/suspicious_msbuild_path.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_msbuild_path.yml)
* [security_content/detections/endpoint/system_processes_run_from_unexpected_locations.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/system_processes_run_from_unexpected_locations.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**9

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1036.003/T1036.003.yaml):

* Masquerading as Windows LSASS process
* Masquerading as Linux crond process.
* Masquerading - cscript.exe running as notepad.exe
* Masquerading - wscript.exe running as svchost.exe
* Masquerading - powershell.exe running as taskhostw.exe
* Masquerading - non-windows exe running as windows exe
* Masquerading - windows exe running as different windows exe
* Malicious process Masquerading as LSM.exe
* File Extension Masquerading

