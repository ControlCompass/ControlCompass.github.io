# T1562.001: Disable or Modify Tools
**MITRE ATT&CK Tactic(s):** Defense Evasion

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1562/001)**
<blockquote>Adversaries may modify and/or disable security tools to avoid possible detection of their malware/tools and activities. This may take the many forms, such as killing security software processes or services, modifying / deleting Registry keys or configuration files so that tools do not operate properly, or other methods to interfere with security tools scanning or reporting information.

Adversaries may also tamper with artifacts deployed and utilized by security tools. Security tools may make dynamic changes to system components in order to maintain visibility into specific events. For example, security products may load their own modules and/or modify those loaded by processes to facilitate data collection. Similar to [Indicator Blocking](https://attack.mitre.org/techniques/T1562/006), adversaries may unhook or otherwise modify these features added by tools (especially those that exist in userland or are otherwise potentially accessible to adversaries) to avoid detection.(Citation: OutFlank System Calls)(Citation: MDSec System Calls)</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**7

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Process Self-Modification Detection](https://d3fend.mitre.org/techniques/d3f:ProcessSelf-ModificationDetection)
* [Process Spawn Analysis](https://d3fend.mitre.org/techniques/d3f:ProcessSpawnAnalysis)
* [Process Termination](https://d3fend.mitre.org/techniques/d3f:ProcessTermination)
* [System Daemon Monitoring](https://d3fend.mitre.org/techniques/d3f:SystemDaemonMonitoring)
* [Hardware-based Process Isolation](https://d3fend.mitre.org/techniques/d3f:Hardware-basedProcessIsolation)
* [Mandatory Access Control](https://d3fend.mitre.org/techniques/d3f:MandatoryAccessControl)
* [Process Lineage Analysis](https://d3fend.mitre.org/techniques/d3f:ProcessLineageAnalysis)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:**2

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2016-04-003.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2016-04-003.yaml)
* [car/analytics/CAR-2021-01-007.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-01-007.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**51

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/cloud/aws/aws_cloudtrail_disable_logging.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/aws_cloudtrail_disable_logging.yml)
* [sigma/rules/cloud/aws/aws_config_disable_recording.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/aws_config_disable_recording.yml)
* [sigma/rules/cloud/aws/aws_guardduty_disruption.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/aws_guardduty_disruption.yml)
* [sigma/rules/cloud/aws/aws_macic_evasion.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/aws/aws_macic_evasion.yml)
* [sigma/rules/cloud/azure/azure_kubernetes_events_deleted.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/cloud/azure/azure_kubernetes_events_deleted.yml)
* [sigma/rules/macos/process_creation/proc_creation_macos_disable_security_tools.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_disable_security_tools.yml)
* [sigma/rules/network/cisco/aaa/cisco_cli_disable_logging.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/network/cisco/aaa/cisco_cli_disable_logging.yml)
* [sigma/rules/windows/builtin/application/win_susp_msmpeng_crash.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/win_susp_msmpeng_crash.yml)
* [sigma/rules/windows/builtin/security/win_alert_enable_weak_encryption.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_alert_enable_weak_encryption.yml)
* [sigma/rules/windows/builtin/security/win_defender_bypass.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_defender_bypass.yml)
* [sigma/rules/windows/builtin/security/win_net_ntlm_downgrade.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_net_ntlm_downgrade.yml)
* [sigma/rules/windows/builtin/security/win_user_driver_loaded.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_user_driver_loaded.yml)
* [sigma/rules/windows/builtin/system/win_system_defender_disabled.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/win_system_defender_disabled.yml)
* [sigma/rules/windows/builtin/windefend/win_defender_disabled.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/windefend/win_defender_disabled.yml)
* [sigma/rules/windows/builtin/windefend/win_defender_exclusions.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/windefend/win_defender_exclusions.yml)
* [sigma/rules/windows/builtin/windefend/win_defender_tamper_protection_trigger.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/windefend/win_defender_tamper_protection_trigger.yml)
* [sigma/rules/windows/file_event/file_event_win_susp_procexplorer_driver_created_in_tmp_folder.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_susp_procexplorer_driver_created_in_tmp_folder.yml)
* [sigma/rules/windows/powershell/powershell_classic/posh_pc_tamper_with_windows_defender.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_classic/posh_pc_tamper_with_windows_defender.yml)
* [sigma/rules/windows/powershell/powershell_script/posh_ps_tamper_defender.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_tamper_defender.yml)
* [sigma/rules/windows/process_access/proc_access_win_cobaltstrike_bof_injection_pattern.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_access/proc_access_win_cobaltstrike_bof_injection_pattern.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_ke3chang_regadd.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_ke3chang_regadd.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_cleanwipe.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cleanwipe.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_dsim_remove.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_dsim_remove.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_powershell_amsi_bypass.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_amsi_bypass.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_powershell_defender_base64.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_defender_base64.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_powershell_defender_disable_feature.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_defender_disable_feature.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_powershell_defender_exclusion.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_defender_exclusion.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_powershell_disable_windef_av.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powershell_disable_windef_av.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_reg_defender_exclusion.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_defender_exclusion.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_reg_defender_tampering.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_reg_defender_tampering.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_remove_windows_defender_definition_files.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_remove_windows_defender_definition_files.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_disable_eventlog.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_disable_eventlog.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_disable_ie_features.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_disable_ie_features.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_disable_raccine.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_disable_raccine.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_reg_disable_sec_services.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_reg_disable_sec_services.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_service_modification.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_service_modification.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_volsnap_disable.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_volsnap_disable.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_wmic_security_product_uninstall.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_wmic_security_product_uninstall.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uninstall_crowdstrike_falcon.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uninstall_crowdstrike_falcon.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_uninstall_sysmon.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_uninstall_sysmon.yml)
* [sigma/rules/windows/registry/registry_delete/registry_delete_removal_amsi_registry_key.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_delete/registry_delete_removal_amsi_registry_key.yml)
* [sigma/rules/windows/registry/registry_event/registry_event_disable_security_events_logging_adding_reg_key_minint.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_disable_security_events_logging_adding_reg_key_minint.yml)
* [sigma/rules/windows/registry/registry_event/registry_event_net_ntlm_downgrade.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_net_ntlm_downgrade.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_defender_disabled.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_defender_disabled.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_defender_exclusions.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_defender_exclusions.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_defender_realtime_protection_disabled.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_defender_realtime_protection_disabled.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_disabled_exploit_guard_net_protection_on_ms_defender.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_disabled_exploit_guard_net_protection_on_ms_defender.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_disabled_pua_protection_on_microsoft_defender.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_disabled_pua_protection_on_microsoft_defender.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_disabled_tamper_protection_on_microsoft_defender.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_disabled_tamper_protection_on_microsoft_defender.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_disable_microsoft_office_security_features.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_disable_microsoft_office_security_features.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_susp_service_installed.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_susp_service_installed.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**39

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/disable_windows_behavior_monitoring.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_windows_behavior_monitoring.yml)
* [security_content/detections/endpoint/disable_defender_mpengine_registry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_defender_mpengine_registry.yml)
* [security_content/detections/endpoint/excessive_usage_of_taskkill.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/excessive_usage_of_taskkill.yml)
* [security_content/detections/endpoint/disabling_firewall_with_netsh.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_firewall_with_netsh.yml)
* [security_content/detections/endpoint/disabling_controlpanel.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_controlpanel.yml)
* [security_content/detections/endpoint/disabling_defender_services.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_defender_services.yml)
* [security_content/detections/endpoint/hide_user_account_from_sign_in_screen.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/hide_user_account_from_sign_in_screen.yml)
* [security_content/detections/endpoint/powershell_windows_defender_exclusion_commands.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/powershell_windows_defender_exclusion_commands.yml)
* [security_content/detections/endpoint/add_or_set_windows_defender_exclusion.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/add_or_set_windows_defender_exclusion.yml)
* [security_content/detections/endpoint/disable_schedule_task.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_schedule_task.yml)
* [security_content/detections/endpoint/wmic_noninteractive_app_uninstallation.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/wmic_noninteractive_app_uninstallation.yml)
* [security_content/detections/endpoint/windows_defender_exclusion_registry_entry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_defender_exclusion_registry_entry.yml)
* [security_content/detections/endpoint/disable_defender_spynet_reporting.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_defender_spynet_reporting.yml)
* [security_content/detections/endpoint/disable_registry_tool.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_registry_tool.yml)
* [security_content/detections/endpoint/windows_disableantispyware_reg.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_disableantispyware_reg.yml)
* [security_content/detections/endpoint/attempt_to_stop_security_service.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/attempt_to_stop_security_service.yml)
* [security_content/detections/endpoint/disable_defender_blockatfirstseen_feature.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_defender_blockatfirstseen_feature.yml)
* [security_content/detections/endpoint/disable_amsi_through_registry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_amsi_through_registry.yml)
* [security_content/detections/endpoint/disable_show_hidden_files.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_show_hidden_files.yml)
* [security_content/detections/endpoint/disabling_folderoptions_windows_feature.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_folderoptions_windows_feature.yml)
* [security_content/detections/endpoint/disable_defender_submit_samples_consent_feature.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_defender_submit_samples_consent_feature.yml)
* [security_content/detections/endpoint/disable_etw_through_registry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_etw_through_registry.yml)
* [security_content/detections/endpoint/excessive_number_of_service_control_start_as_disabled.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/excessive_number_of_service_control_start_as_disabled.yml)
* [security_content/detections/endpoint/disable_windows_smartscreen_protection.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_windows_smartscreen_protection.yml)
* [security_content/detections/endpoint/windows_excessive_disabled_services_event.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_excessive_disabled_services_event.yml)
* [security_content/detections/endpoint/powershell_remove_windows_defender_directory.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/powershell_remove_windows_defender_directory.yml)
* [security_content/detections/endpoint/disabling_norun_windows_app.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_norun_windows_app.yml)
* [security_content/detections/endpoint/disable_defender_enhanced_notification.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_defender_enhanced_notification.yml)
* [security_content/detections/endpoint/unload_sysmon_filter_driver.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/unload_sysmon_filter_driver.yml)
* [security_content/detections/endpoint/disabling_cmd_application.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_cmd_application.yml)
* [security_content/detections/endpoint/windows_dism_remove_defender.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_dism_remove_defender.yml)
* [security_content/detections/endpoint/windows_raccine_scheduled_task_deletion.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_raccine_scheduled_task_deletion.yml)
* [security_content/detections/endpoint/powershell_disable_security_monitoring.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/powershell_disable_security_monitoring.yml)
* [security_content/detections/endpoint/windows_event_for_service_disabled.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_event_for_service_disabled.yml)
* [security_content/detections/endpoint/process_kill_base_on_file_path.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/process_kill_base_on_file_path.yml)
* [security_content/detections/endpoint/disabling_task_manager.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_task_manager.yml)
* [security_content/detections/endpoint/disabling_systemrestore_in_registry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disabling_systemrestore_in_registry.yml)
* [security_content/detections/endpoint/disable_defender_antivirus_registry.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_defender_antivirus_registry.yml)
* [security_content/detections/endpoint/disable_windows_app_hotkeys.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/disable_windows_app_hotkeys.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**28

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1562.001/T1562.001.yaml):

* Disable syslog
* Disable Cb Response
* Disable SELinux
* Stop Crowdstrike Falcon on Linux
* Disable Carbon Black Response
* Disable LittleSnitch
* Disable OpenDNS Umbrella
* Disable macOS Gatekeeper
* Stop and unload Crowdstrike Falcon on macOS
* Unload Sysmon Filter Driver
* Uninstall Sysmon
* AMSI Bypass - AMSI InitFailed
* AMSI Bypass - Remove AMSI Provider Reg Key
* Disable Arbitrary Security Windows Service
* Tamper with Windows Defender ATP PowerShell
* Tamper with Windows Defender Command Prompt
* Tamper with Windows Defender Registry
* Disable Microsoft Office Security Features
* Remove Windows Defender Definition Files
* Stop and Remove Arbitrary Security Windows Service
* Uninstall Crowdstrike Falcon on Windows
* Tamper with Windows Defender Evade Scanning -Folder
* Tamper with Windows Defender Evade Scanning -Extension
* Tamper with Windows Defender Evade Scanning -Process
* office-365-Disable-AntiPhishRule
* Disable Windows Defender with DISM
* Disable Defender with Defender Control
* Disable Defender Using NirSoft AdvancedRun

### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 70

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2016-04-003.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2016-04-003.yaml): 1 <code>unit_tests</code>

