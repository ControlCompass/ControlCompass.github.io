# T1056.002: GUI Input Capture
**MITRE ATT&CK Tactic(s):** Collection, Credential Access

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1056/002)**
<blockquote>Adversaries may mimic common operating system GUI components to prompt users for credentials with a seemingly legitimate prompt. When programs are executed that need additional privileges than are present in the current user context, it is common for the operating system to prompt the user for proper credentials to authorize the elevated privileges for the task (ex: [Bypass User Account Control](https://attack.mitre.org/techniques/T1548/002)).

Adversaries may mimic this functionality to prompt users for credentials with a seemingly legitimate prompt for a number of reasons that mimic normal usage, such as a fake installer requiring additional access or a fake malware removal suite.(Citation: OSX Malware Exploits MacKeeper) This type of prompt can be used to collect credentials via various languages such as [AppleScript](https://attack.mitre.org/techniques/T1059/002)(Citation: LogRhythm Do You Trust Oct 2014)(Citation: OSX Keydnap malware)(Citation: Spoofing credential dialogs) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).(Citation: LogRhythm Do You Trust Oct 2014)(Citation: Enigma Phishing for Credentials Jan 2015)(Citation: Spoofing credential dialogs) On Linux systems attackers may launch dialog boxes prompting users for credentials from malicious shell scripts or the command line (i.e. [Unix Shell](https://attack.mitre.org/techniques/T1059/004)).(Citation: Spoofing credential dialogs) </blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** May 23, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [no defensive relations yet](https://d3fend.mitre.org/technique/d3f:nodefensiverelationsyet)

## Technical Controls (Detection Rules)
### [Elastic Detection Rules](https://github.com/elastic/detection-rules)
**Last accessed:** May 23, 2022

**Total ATT&CK-mapped rules:** 560

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[rules](https://github.com/elastic/detection-rules/tree/main/rules)</code> folder:

* [macos](https://github.com/elastic/detection-rules/tree/main/rules/macos/) / **[Prompt for Credentials with OSASCRIPT](https://github.com/elastic/detection-rules/blob/main/rules/macos/credential_access_promt_for_pwd_via_osascript.toml)**

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** May 23, 2022

**Total ATT&CK-mapped rules:** 2360

**ATT&CK-mapped resources for this (sub)technique:** 3

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[rules](https://github.com/SigmaHQ/sigma/tree/master/rules)</code> folder:

* [macos](https://github.com/SigmaHQ/sigma/tree/master/rules/macos/) / [process_creation](https://github.com/SigmaHQ/sigma/tree/master/rules/macos/process_creation/) / **[GUI Input Capture - macOS](https://github.com/SigmaHQ/sigma/blob/master/rules/macos/process_creation/proc_creation_macos_gui_input_capture.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [image_load](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/image_load/) / **[UIPromptForCredentials DLLs](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/image_load/image_load_uipromptforcreds_dlls.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [process_creation](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/) / **[Mouse Lock Credential Gathering](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_mouse_lock.yml)**


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** May 23, 2022

**Total ATT&CK-mapped tests:** 1262

**ATT&CK-mapped resources for this (sub)technique:** 4

The following unit tests mapped to this (sub)technique can be located in [the file here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1056.002/T1056.002.yaml):

* AppleScript - Prompt User for Password
* PowerShell - Prompt User for Password
* AppleScript - Prompt User for Password
* PowerShell - Prompt User for Password

