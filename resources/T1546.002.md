# T1546.002: Screensaver
**MITRE ATT&CK Tactic(s):** Privilege Escalation, Persistence

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1546/002)**
<blockquote>Adversaries may establish persistence by executing malicious content triggered by user inactivity. Screensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension.(Citation: Wikipedia Screensaver) The Windows screensaver application scrnsave.scr is located in <code>C:\Windows\System32\</code>, and <code>C:\Windows\sysWOW64\</code>  on 64-bit Windows systems, along with screensavers included with base Windows installations.

The following screensaver settings are stored in the Registry (<code>HKCU\Control Panel\Desktop\</code>) and could be manipulated to achieve persistence:

* <code>SCRNSAVE.exe</code> - set to malicious PE path
* <code>ScreenSaveActive</code> - set to '1' to enable the screensaver
* <code>ScreenSaverIsSecure</code> - set to '0' to not require a password to unlock
* <code>ScreenSaveTimeout</code> - sets user inactivity timeout before screensaver is executed

Adversaries can use screensaver settings to maintain persistence by setting the screensaver to run malware after a certain timeframe of user inactivity. (Citation: ESET Gazer Aug 2017)</blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** May 23, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 7

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Local File Permissions](https://d3fend.mitre.org/technique/d3f:LocalFilePermissions)
* [Executable Allowlisting](https://d3fend.mitre.org/technique/d3f:ExecutableAllowlisting)
* [Decoy File](https://d3fend.mitre.org/technique/d3f:DecoyFile)
* [Dynamic Analysis](https://d3fend.mitre.org/technique/d3f:DynamicAnalysis)
* [Emulated File Analysis](https://d3fend.mitre.org/technique/d3f:EmulatedFileAnalysis)
* [File Analysis](https://d3fend.mitre.org/technique/d3f:FileAnalysis)
* [Executable Denylisting](https://d3fend.mitre.org/technique/d3f:ExecutableDenylisting)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** August 09, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[analytics](https://github.com/mitre-attack/car/blob/master/analytics)</code> folder:

* [Registry Edit from Screensaver](https://github.com/mitre-attack/car/tree/master/analytics/CAR-2020-11-011.yaml)

### [Elastic Detection Rules](https://github.com/elastic/detection-rules)
**Last accessed:** August 09, 2022

**Total ATT&CK-mapped rules:** 641

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[rules](https://github.com/elastic/detection-rules/tree/main/rules)</code> folder:

* [macos](https://github.com/elastic/detection-rules/tree/main/rules/macos/) / **[Unexpected Child Process of macOS Screensaver Engine](https://github.com/elastic/detection-rules/blob/main/rules/macos/persistence_screensaver_engine_unexpected_child_process.toml)**

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** August 09, 2022

**Total ATT&CK-mapped rules:** 2578

**ATT&CK-mapped resources for this (sub)technique:** 4

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[rules](https://github.com/SigmaHQ/sigma/tree/master/rules)</code> folder:

* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [file_event](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/) / **[Suspicious Screensaver Binary File Creation](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_creation_scr_binary_file.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [file_event](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/file_event/) / **[Writing Local Admin Share](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_writing_local_admin_share.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [process_creation](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/process_creation/) / **[Suspicious ScreenSave Change by Reg.exe](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_screensaver_reg.yml)**
* [windows](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/) / [registry](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/) / [registry_event](https://github.com/SigmaHQ/sigma/tree/master/rules/windows/registry/registry_event/) / **[Path To Screensaver Binary Modified](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_modify_screensaver_binary_path.yml)**

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** August 09, 2022

**Total ATT&CK-mapped rules:** 1624

**ATT&CK-mapped resources for this (sub)technique:** 1

Resources mapped to this (sub)technique can be located in the following files within the repository's <code>[detections](https://github.com/splunk/security_content/tree/develop/detections)</code> folder:

* [endpoint](https://github.com/splunk/security_content/tree/develop/detections/endpoint/) / **[Screensaver Event Trigger Execution](https://github.com/splunk/security_content/blob/develop/detections/endpoint/screensaver_event_trigger_execution.yml)**


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** August 10, 2022

**Total ATT&CK-mapped tests:** 1341

**ATT&CK-mapped resources for this (sub)technique:** 2

The following unit tests mapped to this (sub)technique can be located in [the file here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1546.002/T1546.002.yaml):

* Set Arbitrary Binary as Screensaver
* Set Arbitrary Binary as Screensaver

