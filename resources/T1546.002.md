# T1546.002: Screensaver
**MITRE ATT&CK Tactic(s):** Privilege Escalation, Persistence

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1546/002)**
<blockquote>Adversaries may establish persistence by executing malicious content triggered by user inactivity. Screensavers are programs that execute after a configurable time of user inactivity and consist of Portable Executable (PE) files with a .scr file extension.(Citation: Wikipedia Screensaver) The Windows screensaver application scrnsave.scr is located in <code>C:\Windows\System32\</code>, and <code>C:\Windows\sysWOW64\</code>  on 64-bit Windows systems, along with screensavers included with base Windows installations.

The following screensaver settings are stored in the Registry (<code>HKCU\Control Panel\Desktop\</code>) and could be manipulated to achieve persistence:

* <code>SCRNSAVE.exe</code> - set to malicious PE path
* <code>ScreenSaveActive</code> - set to '1' to enable the screensaver
* <code>ScreenSaverIsSecure</code> - set to '0' to not require a password to unlock
* <code>ScreenSaveTimeout</code> - sets user inactivity timeout before screensaver is executed

Adversaries can use screensaver settings to maintain persistence by setting the screensaver to run malware after a certain timeframe of user inactivity. (Citation: ESET Gazer Aug 2017)</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**7

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)
* [Executable Allowlisting](https://d3fend.mitre.org/techniques/d3f:ExecutableAllowlisting)
* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)
* [Dynamic Analysis](https://d3fend.mitre.org/techniques/d3f:DynamicAnalysis)
* [Emulated File Analysis](https://d3fend.mitre.org/techniques/d3f:EmulatedFileAnalysis)
* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)
* [Executable Denylisting](https://d3fend.mitre.org/techniques/d3f:ExecutableDenylisting)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2020-11-011.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2020-11-011.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**4

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/windows/file_event/file_event_win_creation_scr_binary_file.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_creation_scr_binary_file.yml)
* [sigma/rules/windows/file_event/file_event_win_writing_local_admin_share.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_writing_local_admin_share.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_screensaver_reg.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_screensaver_reg.yml)
* [sigma/rules/windows/registry/registry_event/registry_event_modify_screensaver_binary_path.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_modify_screensaver_binary_path.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**1

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/screensaver_event_trigger_execution.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/screensaver_event_trigger_execution.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**2

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1546.002/T1546.002.yaml):

* Set Arbitrary Binary as Screensaver
* Set Arbitrary Binary as Screensaver

