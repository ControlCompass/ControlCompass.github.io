# T1070.004: File Deletion
**MITRE ATT&CK Tactic(s):** Defense Evasion

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1070/004)**
<blockquote>Adversaries may delete files left behind by the actions of their intrusion activity. Malware, tools, or other non-native files dropped or created on a system by an adversary may leave traces to indicate to what was done within a network and how. Removal of these files can occur during an intrusion, or as part of a post-intrusion process to minimize the adversary's footprint.

There are tools available from the host operating system to perform cleanup, but adversaries may use other tools as well. Examples include native [cmd](https://attack.mitre.org/software/S0106) functions such as DEL, secure deletion tools such as Windows Sysinternals SDelete, or other third-party file deletion tools. (Citation: Trend Micro APT Attack Tools)</blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 3

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Decoy File](https://d3fend.mitre.org/techniques/d3f:DecoyFile)
* [File Analysis](https://d3fend.mitre.org/techniques/d3f:FileAnalysis)
* [Local File Permissions](https://d3fend.mitre.org/techniques/d3f:LocalFilePermissions)

## Technical Controls (Detection Rules)
### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:** 11

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/linux/process_creation/proc_creation_lnx_file_deletion.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_file_deletion.yml)
* [sigma/rules/network/cisco/aaa/cisco_cli_file_deletion.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/network/cisco/aaa/cisco_cli_file_deletion.yml)
* [sigma/rules/windows/builtin/application/win_susp_backup_delete.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/application/win_susp_backup_delete.yml)
* [sigma/rules/windows/builtin/security/win_susp_sdelete.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_susp_sdelete.yml)
* [sigma/rules/windows/file_delete/file_delete_win_delete_appli_log.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_delete/file_delete_win_delete_appli_log.yml)
* [sigma/rules/windows/file_delete/file_delete_win_delete_prefetch.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_delete/file_delete_win_delete_prefetch.yml)
* [sigma/rules/windows/file_delete/file_delete_win_sysinternals_sdelete_file_deletion.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_delete/file_delete_win_sysinternals_sdelete_file_deletion.yml)
* [sigma/rules/windows/powershell/powershell_script/posh_ps_remove_item_path.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_remove_item_path.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_cmd_delete.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_cmd_delete.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_del.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_del.yml)
* [sigma/rules/windows/registry/registry_add/registry_add_sysinternals_sdelete_registry_keys.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_add/registry_add_sysinternals_sdelete_registry_keys.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:** 5

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/endpoint/sdelete_application_execution.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/sdelete_application_execution.yml)
* [security_content/detections/endpoint/recursive_delete_of_directory_in_batch_cmd.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/recursive_delete_of_directory_in_batch_cmd.yml)
* [security_content/detections/endpoint/clear_unallocated_sector_using_cipher_app.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/clear_unallocated_sector_using_cipher_app.yml)
* [security_content/detections/endpoint/ssa___sdelete_application_execution.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ssa___sdelete_application_execution.yml)
* [security_content/detections/endpoint/ssa___clear_unallocated_sector_using_cipher_app.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/ssa___clear_unallocated_sector_using_cipher_app.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:** 10

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1070.004/T1070.004.yaml):

* Delete a single file - Linux/macOS
* Delete an entire folder - Linux/macOS
* Overwrite and delete a file with shred
* Delete a single file - Windows cmd
* Delete an entire folder - Windows cmd
* Delete a single file - Windows PowerShell
* Delete an entire folder - Windows PowerShell
* Delete Filesystem - Linux
* Delete Prefetch File
* Delete TeamViewer Log Files

