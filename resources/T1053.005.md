# T1053.005: Scheduled Task
**MITRE ATT&CK Tactic(s):** Execution, Persistence, Privilege Escalation

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1053/005)**
<blockquote>Adversaries may abuse the Windows Task Scheduler to perform task scheduling for initial or recurring execution of malicious code. There are multiple ways to access the Task Scheduler in Windows. The <code>schtasks</code> can be run directly on the command line, or the Task Scheduler can be opened through the GUI within the Administrator Tools section of the Control Panel. In some cases, adversaries have used a .NET wrapper for the Windows Task Scheduler, and alternatively, adversaries have used the Windows netapi32 library to create a scheduled task.

The deprecated [at](https://attack.mitre.org/software/S0110) utility could also be abused by adversaries (ex: [At (Windows)](https://attack.mitre.org/techniques/T1053/002)), though <code>at.exe</code> can not access tasks created with <code>schtasks</code> or the Control Panel.

An adversary may use Windows Task Scheduler to execute programs at system startup or on a scheduled basis for persistence. The Windows Task Scheduler can also be abused to conduct remote Execution as part of Lateral Movement and or to run a process under the context of a specified account (such as SYSTEM).</blockquote>
## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:**4

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Process Spawn Analysis](https://d3fend.mitre.org/techniques/d3f:ProcessSpawnAnalysis)
* [System Call Analysis](https://d3fend.mitre.org/techniques/d3f:SystemCallAnalysis)
* [Scheduled Job Analysis](https://d3fend.mitre.org/techniques/d3f:ScheduledJobAnalysis)
* [System Call Filtering](https://d3fend.mitre.org/techniques/d3f:SystemCallFiltering)

## Technical Controls (Detection Rules)
### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 159

**ATT&CK-mapped resources for this (sub)technique:**6

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-01-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-01-002.yaml)
* [car/analytics/CAR-2013-04-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-04-002.yaml)
* [car/analytics/CAR-2013-08-001.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-08-001.yaml)
* [car/analytics/CAR-2015-04-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2015-04-002.yaml)
* [car/analytics/CAR-2020-09-001.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2020-09-001.yaml)
* [car/analytics/CAR-2021-12-001.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-12-001.yaml)

### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:**28

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/windows/builtin/security/win_apt_chafer_mar18_security.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_apt_chafer_mar18_security.yml)
* [sigma/rules/windows/builtin/security/win_apt_wocao.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_apt_wocao.yml)
* [sigma/rules/windows/builtin/security/win_gpo_scheduledtasks.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_gpo_scheduledtasks.yml)
* [sigma/rules/windows/builtin/security/win_rare_schtasks_creations.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_rare_schtasks_creations.yml)
* [sigma/rules/windows/builtin/security/win_scheduled_task_deletion.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/security/win_scheduled_task_deletion.yml)
* [sigma/rules/windows/builtin/system/win_apt_chafer_mar18_system.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/system/win_apt_chafer_mar18_system.yml)
* [sigma/rules/windows/builtin/taskscheduler/win_rare_schtask_creation.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/builtin/taskscheduler/win_rare_schtask_creation.yml)
* [sigma/rules/windows/powershell/powershell_script/posh_ps_cmdlet_scheduled_task.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_cmdlet_scheduled_task.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_actinium_persistence.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_actinium_persistence.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_chafer_mar18.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_chafer_mar18.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_slingshot.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_slingshot.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_turla_comrat_may20.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_turla_comrat_may20.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_apt_wocao.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_apt_wocao.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_powersploit_empire_schtasks.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_powersploit_empire_schtasks.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_schtasks_appdata_local_system.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_appdata_local_system.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_schtasks_powershell_windowsapps_execution.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_powershell_windowsapps_execution.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_schtasks_reg_loader.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_schtasks_env_folder.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_schtasks_env_folder.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_schtasks_folder_combos.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_schtasks_folder_combos.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_schtasks_parent.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_schtasks_parent.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_schtasks_pattern.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_schtasks_pattern.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_schtasks_user_temp.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_schtasks_user_temp.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_schtask_creation.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_schtask_creation.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_schtask_creation_temp_folder.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_schtask_creation_temp_folder.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_win10_sched_task_0day.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_win10_sched_task_0day.yml)
* [sigma/rules/windows/registry/registry_event/registry_event_apt_chafer_mar18.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_event/registry_event_apt_chafer_mar18.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_taskcache_entry.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_taskcache_entry.yml)
* [sigma/rules/windows/registry/registry_set/registry_set_telemetry_persistence.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/registry/registry_set/registry_set_telemetry_persistence.yml)

### [Splunk Security Content](https://github.com/splunk/security_content)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped rules:** 1393

**ATT&CK-mapped resources for this (sub)technique:**13

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/splunk/security_content/tree/develop/detections):

* [security_content/detections/deprecated/scheduled_tasks_used_in_badrabbit_ransomware.yml](https://github.com/splunk/security_content/blob/develop/detections/deprecated/scheduled_tasks_used_in_badrabbit_ransomware.yml)
* [security_content/detections/endpoint/scheduled_task_initiation_on_remote_endpoint.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/scheduled_task_initiation_on_remote_endpoint.yml)
* [security_content/detections/endpoint/winevent_windows_task_scheduler_event_action_started.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/winevent_windows_task_scheduler_event_action_started.yml)
* [security_content/detections/endpoint/schtasks_scheduling_job_on_remote_system.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/schtasks_scheduling_job_on_remote_system.yml)
* [security_content/detections/endpoint/short_lived_scheduled_task.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/short_lived_scheduled_task.yml)
* [security_content/detections/endpoint/winevent_scheduled_task_created_within_public_path.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/winevent_scheduled_task_created_within_public_path.yml)
* [security_content/detections/endpoint/possible_lateral_movement_powershell_spawn.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/possible_lateral_movement_powershell_spawn.yml)
* [security_content/detections/endpoint/scheduled_task_deleted_or_created_via_cmd.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/scheduled_task_deleted_or_created_via_cmd.yml)
* [security_content/detections/endpoint/svchost_exe_lolbas_execution_process_spawn.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/svchost_exe_lolbas_execution_process_spawn.yml)
* [security_content/detections/endpoint/schtasks_used_for_forcing_a_reboot.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/schtasks_used_for_forcing_a_reboot.yml)
* [security_content/detections/endpoint/winevent_scheduled_task_created_to_spawn_shell.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/winevent_scheduled_task_created_to_spawn_shell.yml)
* [security_content/detections/endpoint/windows_schtasks_create_run_as_system.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/windows_schtasks_create_run_as_system.yml)
* [security_content/detections/endpoint/suspicious_scheduled_task_from_public_directory.yml](https://github.com/splunk/security_content/blob/develop/detections/endpoint/suspicious_scheduled_task_from_public_directory.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:**21

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1053.005/T1053.005.yaml):

* Scheduled Task Startup Script
* Scheduled task Local
* Scheduled task Remote
* Powershell Cmdlet Scheduled Task
* Task Scheduler via VBA
* WMI Invoke-CimMethod Scheduled Task
* Scheduled Task Executing Base64 Encoded Commands From Registry
* Scheduled Task Startup Script
* Scheduled task Local
* Scheduled task Remote
* Powershell Cmdlet Scheduled Task
* Task Scheduler via VBA
* WMI Invoke-CimMethod Scheduled Task
* Scheduled Task Executing Base64 Encoded Commands From Registry
* Scheduled Task Startup Script
* Scheduled task Local
* Scheduled task Remote
* Powershell Cmdlet Scheduled Task
* Task Scheduler via VBA
* WMI Invoke-CimMethod Scheduled Task
* Scheduled Task Executing Base64 Encoded Commands From Registry

### [Cyber Analytics Repository](https://car.mitre.org)
**Last accessed:** April 25, 2022

**Total ATT&CK-mapped tests:** 70

**ATT&CK-mapped resources for this (sub)technique:**3

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/mitre-attack/car/blob/master/analytics):

* [car/analytics/CAR-2013-04-002.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-04-002.yaml): 1 <code>unit_tests</code>
* [car/analytics/CAR-2013-08-001.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2013-08-001.yaml): 1 <code>unit_tests</code>
* [car/analytics/CAR-2021-12-001.yaml](https://github.com/mitre-attack/car/blob/master/analytics/CAR-2021-12-001.yaml): 2 <code>unit_tests</code>

