# T1552.004: Private Keys
**MITRE ATT&CK Tactic(s):** Credential Access

**[MITRE ATT&CK Description](https://attack.mitre.org/techniques/T1552/004)**
<blockquote>Adversaries may search for private key certificate files on compromised systems for insecurely stored credentials. Private cryptographic keys and certificates are used for authentication, encryption/decryption, and digital signatures.(Citation: Wikipedia Public Key Crypto) Common key and certificate file extensions include: .key, .pgp, .gpg, .ppk., .p12, .pem, .pfx, .cer, .p7b, .asc. 

Adversaries may also look in common key directories, such as <code>~/.ssh</code> for SSH keys on * nix-based systems or <code>C:&#92;Users&#92;(username)&#92;.ssh&#92;</code> on Windows. These private keys can be used to authenticate to [Remote Services](https://attack.mitre.org/techniques/T1021) like SSH or for use in decrypting other collected files such as email.

Adversary tools have been discovered that search compromised systems for file extensions relating to cryptographic keys and certificates.(Citation: Kaspersky Careto)(Citation: Palo Alto Prince of Persia)

Some private keys require a password or passphrase for operation, so an adversary may also use [Input Capture](https://attack.mitre.org/techniques/T1056) for keylogging or attempt to [Brute Force](https://attack.mitre.org/techniques/T1110) the passphrase off-line.</blockquote>

## Policy / Process Controls
### [MITRE D3FEND](https://d3fend.mitre.org/)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped resources:** 2328

**ATT&CK-mapped resources for this (sub)technique:** 4

Resources mapped to this (sub)technique can be viewed on [this page](https://d3fend.mitre.org/) (see also the [ATT&CK to D3FEND Mapper](https://d3fend.mitre.org/tools/attack-mapper) tool):

* [Decoy User Credential](https://d3fend.mitre.org/techniques/d3f:DecoyUserCredential)
* [Credential Compromise Scope Analysis](https://d3fend.mitre.org/techniques/d3f:CredentialCompromiseScopeAnalysis)
* [Authentication Cache Invalidation](https://d3fend.mitre.org/techniques/d3f:AuthenticationCacheInvalidation)
* [Credential Transmission Scoping](https://d3fend.mitre.org/techniques/d3f:CredentialTransmissionScoping)

## Technical Controls (Detection Rules)
### [Sigma rules public repository](https://github.com/SigmaHQ/sigma)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped rules:** 2330

**ATT&CK-mapped resources for this (sub)technique:** 5

Resources mapped to this (sub)technique can be located in the following files within [this repository](https://github.com/SigmaHQ/sigma/tree/master/rules):

* [sigma/rules/network/cisco/aaa/cisco_cli_crypto_actions.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/network/cisco/aaa/cisco_cli_crypto_actions.yml)
* [sigma/rules/windows/file_event/file_event_win_susp_pfx_file_creation.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/file_event/file_event_win_susp_pfx_file_creation.yml)
* [sigma/rules/windows/powershell/powershell_script/posh_ps_suspicious_export_pfxcertificate.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/powershell/powershell_script/posh_ps_suspicious_export_pfxcertificate.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_discover_private_keys.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_discover_private_keys.yml)
* [sigma/rules/windows/process_creation/proc_creation_win_susp_powershell_getprocess_lsass.yml](https://github.com/SigmaHQ/sigma/blob/master/rules/windows/process_creation/proc_creation_win_susp_powershell_getprocess_lsass.yml)


## Offensive Security Tests
### [Atomic Red Team](https://github.com/redcanaryco/atomic-red-team)
**Last accessed:** April 27, 2022

**Total ATT&CK-mapped tests:** 1161

**ATT&CK-mapped resources for this (sub)technique:** 7

The following unit tests mapped to this (sub)technique can be located in the file [here](https://github.com/redcanaryco/atomic-red-team/tree/master/atomics/T1552.004/T1552.004.yaml):

* Private Keys
* Discover Private SSH Keys
* Copy Private SSH Keys with CP
* Copy Private SSH Keys with rsync
* Copy the users GnuPG directory with rsync
* ADFS token signing and encryption certificates theft - Local
* ADFS token signing and encryption certificates theft - Remote

